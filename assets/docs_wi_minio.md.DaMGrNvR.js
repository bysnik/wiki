import{_ as i,c as a,o as n,ag as t}from"./chunks/framework.D4Vqf8I7.js";const e="/wiki/assets/minio-cluster-status.DzIU87qW.png",h="/wiki/assets/minio.Dhz9KRMY.png",g=JSON.parse('{"title":"MinIO","description":"","frontmatter":{"outline":"deep"},"headers":[],"relativePath":"docs/wi/minio.md","filePath":"docs/wi/minio.md","lastUpdated":1755760684000}'),l={name:"docs/wi/minio.md"};function p(k,s,d,o,r,c){return n(),a("div",null,s[0]||(s[0]=[t(`<h1 id="minio" tabindex="-1">MinIO <a class="header-anchor" href="#minio" aria-label="Permalink to &quot;MinIO&quot;">​</a></h1><p><img src="https://media2.dev.to/dynamic/image/width=1000,height=420,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2F1kco4frqn1sh3y3umvye.png" alt=""></p><p>MiniIO — это высокопроизводительное, легковесное объектное хранилище данных с открытым исходным кодом, совместимое с Amazon S3 API, предназначенное для работы в облачных и локальных средах. Оно обеспечивает масштабируемое и отказоустойчивое хранение больших объёмов неструктурированных данных, таких как изображения, видео, логи и резервные копии, поддерживая при этом высокую скорость доступа и минимальные задержки. Благодаря модульной архитектуре и простоте развёртывания MinIO идеально подходит для Kubernetes, edge-устройств и гибридных инфраструктур, предлагая инструменты для репликации, шифрования и управления доступом через IAM-подобную политику. Его эффективность и низкие требования к ресурсам делают его популярным выбором для DevOps, разработчиков и компаний, ищущих S3-совместимое решение без сложностей традиционных облачных хранилищ.</p><p><a href="https://packages.altlinux.org/ru/p11/binary/minio/x86_64/" target="_blank" rel="noreferrer">https://packages.altlinux.org/ru/p11/binary/minio/x86_64/</a> Да, пакет есть, но я решил использовать общепринятый вариант установки, а не пакетированный.</p><div class="danger custom-block"><p class="custom-block-title">Внимание</p><p>Инструкции по установке это лишь примеры. Вы можете делать (почти) любую конфигурацию. Главное, чтобы на всех нодах были одинаковые диски и их было одинаковое количество.</p><p>А на единственной ноде можете делать сколь угодно ОДИНАКОВЫХ дисков.</p><p>Если диски будут разные по объему, то, как и в RAID-массивах, доступный объем будет расчитан по самому маленькому диску.</p><p>Для обеспечения лучшей производительности используйте файловую систему XFS. В MinIO не различаются типы дисков и не используются смешанные типы хранилищ, поэтому на всех нодах должен использоваться одинаковый тип дисков (NVMe, SSD или HDD) с одинаковой ёмкостью, например, N ТБ.</p><p>В MinIO ограничивается размер используемого диска до самого маленького диска в развёртывании. Например, если в развёртывании есть 15 дисков по 10 ТБ и 1 диск по 1 ТБ, в MinIO ёмкость каждого диска ограничится до 1 ТБ.</p></div><h2 id="установка-одна-нода-два-диска" tabindex="-1">Установка: одна нода, два диска <a class="header-anchor" href="#установка-одна-нода-два-диска" aria-label="Permalink to &quot;Установка: одна нода, два диска&quot;">​</a></h2><h3 id="шаг-1-подготовка-дисков" tabindex="-1">Шаг 1. Подготовка дисков <a class="header-anchor" href="#шаг-1-подготовка-дисков" aria-label="Permalink to &quot;Шаг 1. Подготовка дисков&quot;">​</a></h3><p>Создайте каталоги для монтирования дисков:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/lib/minio/data1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/lib/minio/data2</span></span></code></pre></div><p>Подготовьте файловую систему XFS на дисках (например, для дисков <code>/dev/sdb</code> и <code>/dev/sdc</code>):</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkfs.xfs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DISK1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkfs.xfs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DISK2</span></span></code></pre></div><p>Добавьте точки монтирования дисков в файле <code>/etc/fstab</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LABEL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DISK1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /var/lib/minio/data1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xfs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> defaults,noatime</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LABEL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DISK2</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /var/lib/minio/data2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xfs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> defaults,noatime</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span></code></pre></div><p>Проверьте монтирование подготовленных дисков:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mount</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -av</span></span></code></pre></div><h3 id="шаг-2-установка-minio" tabindex="-1">Шаг 2. Установка MinIO <a class="header-anchor" href="#шаг-2-установка-minio" aria-label="Permalink to &quot;Шаг 2. Установка MinIO&quot;">​</a></h3><p>Загрузите последний стабильный binary-файл MinIO:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://dl.min.io/server/minio/release/linux-amd64/minio</span></span></code></pre></div><p>Дайте файлу права на выполнение:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio</span></span></code></pre></div><p>Переместите файл в системную директорию:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/bin/</span></span></code></pre></div><h3 id="шаг-3-установка-minio-client" tabindex="-1">Шаг 3. Установка MinIO Client <a class="header-anchor" href="#шаг-3-установка-minio-client" aria-label="Permalink to &quot;Шаг 3. Установка MinIO Client&quot;">​</a></h3><p>Загрузите последний стабильный binary-файл MinIO Client:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://dl.min.io/client/mc/release/linux-amd64/mc</span></span></code></pre></div><p>Дайте файлу права на выполнение:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mc</span></span></code></pre></div><p>Переместите файл в системную директорию:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/bin/</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">Предупреждение</p><p>В Альте есть предустановленный Midnight Commander (команда <code>mc</code>), поэтому либо удалите его, если не нужен, либо переименуйте minio-client (файл <code>mc</code>), ну либо в дальнейшем обращайтесь к клиенту по полному пути: <code>/usr/local/bin/mc</code></p></div><h3 id="шаг-4-создание-пользователя-и-группы-minio-user" tabindex="-1">Шаг 4. Создание пользователя и группы minio-user <a class="header-anchor" href="#шаг-4-создание-пользователя-и-группы-minio-user" aria-label="Permalink to &quot;Шаг 4. Создание пользователя и группы minio-user&quot;">​</a></h3><p>Создайте группу и пользователя:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">groupadd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio-user</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">useradd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -M</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio-user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio-user</span></span></code></pre></div><p>Создайте директории для хранения TLS-сертификатов:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/minio/certs/CAs</span></span></code></pre></div><p>Задайте разрешения на доступ к каталогам:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chown</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio-user:minio-user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/minio</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chown</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio-user:minio-user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/lib/minio</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> u+rxw</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/lib/minio</span></span></code></pre></div><h3 id="шаг-5-создание-фаила-сервиса-для-systemd" tabindex="-1">Шаг 5. Создание файла сервиса для systemd <a class="header-anchor" href="#шаг-5-создание-фаила-сервиса-для-systemd" aria-label="Permalink to &quot;Шаг 5. Создание файла сервиса для systemd&quot;">​</a></h3><p>Загрузите официальный файл сервиса MinIO:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -O</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://raw.githubusercontent.com/minio/minio-service/master/linux-systemd/minio.service</span></span></code></pre></div><p>Проверьте содержимое minio.service и переместите файл:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio.service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/systemd/system</span></span></code></pre></div><div class="danger custom-block"><p class="custom-block-title">Бууу, опасссно</p><p>На этом шаге не запускайте <code>minio.service</code>.</p></div><h3 id="шаг-6-создание-фаила-окружения-для-minio" tabindex="-1">Шаг 6. Создание файла окружения для MinIO <a class="header-anchor" href="#шаг-6-создание-фаила-окружения-для-minio" aria-label="Permalink to &quot;Шаг 6. Создание файла окружения для MinIO&quot;">​</a></h3><p>Создайте файл окружения в <code>/etc/default/minio</code>. Пример содержимого:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Set the hosts and volumes MinIO uses at startup</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MINIO_VOLUMES</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/var/lib/minio/data1/minio /var/lib/minio/data2/minio&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Set all MinIO server options</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MINIO_OPTS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;--certs-dir /etc/minio/certs --console-address :9001&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MINIO_REGION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ru-central-1&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MINIO_ROOT_USER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;YOUR_ROOT_USER&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MINIO_ROOT_PASSWORD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;YOUR_ROOT_PASSWORD&quot;</span></span></code></pre></div><h3 id="шаг-7-запуск-сервиса-minio" tabindex="-1">Шаг 7. Запуск сервиса MinIO <a class="header-anchor" href="#шаг-7-запуск-сервиса-minio" aria-label="Permalink to &quot;Шаг 7. Запуск сервиса MinIO&quot;">​</a></h3><p>Выполните команды для запуска службы:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio.service</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio.service</span></span></code></pre></div><p>Убедитесь, что сервис запустился без ошибок:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio.service</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">journalctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio.service</span></span></code></pre></div><h3 id="шаг-8-настроика-подключения-к-minio" tabindex="-1">Шаг 8. Настройка подключения к MinIO <a class="header-anchor" href="#шаг-8-настроика-подключения-к-minio" aria-label="Permalink to &quot;Шаг 8. Настройка подключения к MinIO&quot;">​</a></h3><p>После запуска сервиса вы сможете открыть браузер и перейти на страницу <code>http://&lt;IP-адрес сервера&gt;:9001</code> — там откроется панель управления хранилищем S3.</p><p>Логин по умолчанию: minioadmin Пароль по умолчанию: minioadmin</p><h2 id="установка-две-ноды-два-диска" tabindex="-1">Установка: две ноды, два диска <a class="header-anchor" href="#установка-две-ноды-два-диска" aria-label="Permalink to &quot;Установка: две ноды, два диска&quot;">​</a></h2><h3 id="шаг-1-подготовка-нод-серверов" tabindex="-1">Шаг 1. Подготовка нод (серверов) <a class="header-anchor" href="#шаг-1-подготовка-нод-серверов" aria-label="Permalink to &quot;Шаг 1. Подготовка нод (серверов)&quot;">​</a></h3><p>Создайте две ноды (сервера) с последовательно пронумерованными именами хостов (Если есть DNS), например:</p><ul><li>minio1.example.com;</li><li>minio2.example.com;</li></ul><h3 id="шаг-2-подготовка-дисков" tabindex="-1">Шаг 2. Подготовка дисков <a class="header-anchor" href="#шаг-2-подготовка-дисков" aria-label="Permalink to &quot;Шаг 2. Подготовка дисков&quot;">​</a></h3><p>На каждой ноде создайте два каталога для монтирования двух дисков:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/lib/minio/data1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/lib/minio/data2</span></span></code></pre></div><p>На каждой ноде подготовьте на дисках файловую систему XFS:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkfs.xfs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DISK1</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkfs.xfs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/sdc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DISK2</span></span></code></pre></div><p>На каждой ноде добавьте точки монтирования четырёх дисков в файле <code>/etc/fstab</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LABEL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DISK1</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      /var/lib/minio/data1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     xfs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     defaults,noatime</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LABEL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DISK2</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      /var/lib/minio/data2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     xfs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     defaults,noatime</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">       2</span></span></code></pre></div><p>Проверьте монтирование ранее подготовленных дисков:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mount</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -av</span></span></code></pre></div><h3 id="шаг-3-установка-minio" tabindex="-1">Шаг 3. Установка MinIO <a class="header-anchor" href="#шаг-3-установка-minio" aria-label="Permalink to &quot;Шаг 3. Установка MinIO&quot;">​</a></h3><p>На каждой ноде загрузите последний стабильный binary-файл MinIO и установите его в систему:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://dl.min.io/server/minio/release/linux-amd64/minio</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/bin/</span></span></code></pre></div><h3 id="шаг-4-установка-minio-client" tabindex="-1">Шаг 4. Установка MinIO Client <a class="header-anchor" href="#шаг-4-установка-minio-client" aria-label="Permalink to &quot;Шаг 4. Установка MinIO Client&quot;">​</a></h3><p>На ноде minio1.example.com загрузите последний стабильный binary-файл MinIO Client и установите его в систему:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://dl.min.io/client/mc/release/linux-amd64/mc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /usr/local/bin/</span></span></code></pre></div><p>Не забудьте решить проблему с Midnight Commander&#39;ом</p><h3 id="шаг-5-создание-пользователя-и-группы-minio-user" tabindex="-1">Шаг 5. Создание пользователя и группы minio-user <a class="header-anchor" href="#шаг-5-создание-пользователя-и-группы-minio-user" aria-label="Permalink to &quot;Шаг 5. Создание пользователя и группы minio-user&quot;">​</a></h3><p>На каждой ноде создайте пользователя и группу <code>minio-user</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">groupadd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio-user</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">useradd</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -M</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio-user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio-user</span></span></code></pre></div><p>На каждой ноде cоздайте директории для хранения TLS сертификатов, выполнив команду:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mkdir</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/minio/certs/CAs</span></span></code></pre></div><p>На каждой ноде задайте разрешения на доступ к каталогам, предназначенным для использования в MinIO:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chown</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio-user:minio-user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/minio</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chown</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -R</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio-user:minio-user</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/lib/minio</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> u+rxw</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/lib/minio</span></span></code></pre></div><h3 id="шаг-6-создание-фаила-сервиса-для-systemd" tabindex="-1">Шаг 6. Создание файла сервиса для systemd <a class="header-anchor" href="#шаг-6-создание-фаила-сервиса-для-systemd" aria-label="Permalink to &quot;Шаг 6. Создание файла сервиса для systemd&quot;">​</a></h3><p>На каждой ноде загрузите официальный файл сервиса MinIO:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -O</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://raw.githubusercontent.com/minio/minio-service/master/linux-systemd/minio.service</span></span></code></pre></div><p>Проверьте содержимое minio.service перед его использованием и переместите этот файл в каталог конфигурации systemd:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio.service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/systemd/system</span></span></code></pre></div><div class="danger custom-block"><p class="custom-block-title">Бууу, опассноссс</p><p>На этом шаге не запускайте <code>minio.service</code>.</p></div><h3 id="шаг-7-создание-фаила-окружения-для-minio" tabindex="-1">Шаг 7. Создание файла окружения для MinIO <a class="header-anchor" href="#шаг-7-создание-фаила-окружения-для-minio" aria-label="Permalink to &quot;Шаг 7. Создание файла окружения для MinIO&quot;">​</a></h3><p>На каждой ноде создайте файл окружения в <code>/etc/default/minio</code>. Служба MinIO использует этот файл в качестве источника всех переменных окружения, используемых MinIO и файлом <code>minio.service</code>.</p><p>Пример файла окружения в <code>/etc/default/minio</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MINIO_VOLUMES</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;http://minio{1...2}.example.com:9000/var/lib/minio/data{1...2}/minio&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MINIO_OPTS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;--certs-dir /etc/minio/certs --console-address :9001&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MINIO_REGION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ru-central-1&quot;</span></span></code></pre></div><h3 id="шаг-8-запуск-сервиса-minio" tabindex="-1">Шаг 8. Запуск сервиса MinIO <a class="header-anchor" href="#шаг-8-запуск-сервиса-minio" aria-label="Permalink to &quot;Шаг 8. Запуск сервиса MinIO&quot;">​</a></h3><p>Выполните следующие команды на каждой ноде, чтобы запустить службу MinIO:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio.service</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio.service</span></span></code></pre></div><p>Убедитесь в том, что сервис <code>minio.service</code> запустился и работает без ошибок:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio.service</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">journalctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> minio.service</span></span></code></pre></div><h3 id="шаг-9-просмотр-статуса-minio" tabindex="-1">Шаг 9. Просмотр статуса MinIO <a class="header-anchor" href="#шаг-9-просмотр-статуса-minio" aria-label="Permalink to &quot;Шаг 9. Просмотр статуса MinIO&quot;">​</a></h3><p>Создайте <code>alias</code> для minio на ноде <code>minio1.example.com</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> alias</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> myminio</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://minio1.example.com:9000</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MINIO_ROOT_USE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">R</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">MINIO_ROOT_PASSWOR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">D</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div><p>Просмотр статуса:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> admin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> info</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> myminio</span></span></code></pre></div><p><img src="`+e+'" alt="minio-cluster-status"></p><h3 id="шаг-10-создание-бакета" tabindex="-1">Шаг 10. Создание бакета <a class="header-anchor" href="#шаг-10-создание-бакета" aria-label="Permalink to &quot;Шаг 10. Создание бакета&quot;">​</a></h3><p>Чтобы создать бакет c наименованием <code>testbucket</code>, используйте команду на ноде <code>minio1.example.com</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mb</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> myminio/testbucket</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --region=ru-central-1</span></span></code></pre></div><h2 id="настроика-включения-tls-ssl-в-minio" tabindex="-1">Настройка включения TLS/SSL в MinIO <a class="header-anchor" href="#настроика-включения-tls-ssl-в-minio" aria-label="Permalink to &quot;Настройка включения TLS/SSL в MinIO&quot;">​</a></h2><p>Для включения поддержки TLS/SSL в MinIO нужно на каждой ноде:</p><ol><li>В файле окружения <code>/etc/default/minio</code> изменить протокол с HTTP на HTTPS в параметре <code>MINIO_VOLUMES</code>.</li><li>Положить файл сертификата и файл закрытого ключа в каталог <code>/etc/minio/certs</code>.</li><li>Все ноды имеют уникальные доменные имена. Сертификаты должны быть выпущены для каждой ноды индивидуально.</li><li>Переименовать файл сертификата сервера в <code>public.crt</code>.</li><li>Переименовать файл закрытого ключа в <code>private.key</code>.</li></ol><p>При использовании самоподписанных сертификатов положить файл корневого CA в каталог <code>/etc/minio/certs/CAs</code>.</p><h2 id="проблема-отсутствие-панели-администратора-в-веб-интерфеисе" tabindex="-1">Проблема: отсутствие панели администратора в веб-интерфейсе <a class="header-anchor" href="#проблема-отсутствие-панели-администратора-в-веб-интерфеисе" aria-label="Permalink to &quot;Проблема: отсутствие панели администратора в веб-интерфейсе&quot;">​</a></h2><p><img src="'+h+`" alt="minio-console"></p><div class="tip custom-block"><p class="custom-block-title">Цитата со страницы <a href="https://docs.min.io/community/minio-object-store/administration/minio-console.html" target="_blank" rel="noreferrer">документации</a></p><p>Изменено в версии <code>RELEASE.2025-05-24T17-08-30Z</code>: Консоль теперь предоставляет только возможности обозревателя объектов, аналогичные доступным в <code>mc</code> инструменте. Для административных действий, таких как управление пользователями, используйте команду <code>mc admin</code></p></div><p>Вот и вся проблема. Они тупо вырезали весь административный интерфейс из веб-консоли. Ну огонь вообще.</p><p>Теперь в графике можно создавать и удалять бакеты, и загружать/удалять из них файлы, ну и по мелочи ещё.</p><h2 id="моментики" tabindex="-1">Моментики <a class="header-anchor" href="#моментики" aria-label="Permalink to &quot;Моментики&quot;">​</a></h2><div class="tip custom-block"><p class="custom-block-title">Гайды устарели!</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MINIO_ACCESS_KEY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;YOUR_ACCESS_KEY&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">MINIO_SECRET_KEY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;YOUR_SECRET_KEY&quot;</span></span></code></pre></div><p>Эти переменные являются устаревшими, с ними MinIO не запустится. Вместо них используются логин/пароль от любого пользователя. Главное не забыть выдать этому пользователю необходимые права доступа.</p></div><div class="tip custom-block"><p class="custom-block-title">Ох уж этот S3</p><p>По опыту работы с MinIO в связке с <a href="./harbor.html#s3-хранилище">Harbor</a> была получена информация, что работают ТОЛЬКО <a href="https://github.com/aws/aws-sdk-go/blob/v1.44.130/aws/endpoints/defaults.go#L141" target="_blank" rel="noreferrer">стандартные ASW регионы</a>. Так что будьте внимательны!</p></div>`,117)]))}const m=i(l,[["render",p]]);export{g as __pageData,m as default};
