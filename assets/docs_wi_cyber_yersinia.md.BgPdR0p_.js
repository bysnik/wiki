import{_ as s,c as e,o as i,ag as t}from"./chunks/framework.D4Vqf8I7.js";const g=JSON.parse('{"title":"yersinia","description":"","frontmatter":{},"headers":[],"relativePath":"docs/wi/cyber/yersinia.md","filePath":"docs/wi/cyber/yersinia.md","lastUpdated":1766675064000}'),p={name:"docs/wi/cyber/yersinia.md"};function r(o,a,n,l,c,h){return i(),e("div",null,a[0]||(a[0]=[t(`<h1 id="yersinia" tabindex="-1">yersinia <a class="header-anchor" href="#yersinia" aria-label="Permalink to &quot;yersinia&quot;">​</a></h1><h2 id="назначение" tabindex="-1">Назначение <a class="header-anchor" href="#назначение" aria-label="Permalink to &quot;Назначение&quot;">​</a></h2><p>Пакет &#39;yersinia&#39; действительно не найден в ALT Linux p11 (x86_64/i586/noarch).</p><p>ArchWiki: [страница не найдена] (<a href="https://wiki.archlinux.org/title/Yersinia" target="_blank" rel="noreferrer">https://wiki.archlinux.org/title/Yersinia</a>)</p><h2 id="установка" tabindex="-1">Установка <a class="header-anchor" href="#установка" aria-label="Permalink to &quot;Установка&quot;">​</a></h2><h3 id="alt-linux" tabindex="-1">ALT Linux <a class="header-anchor" href="#alt-linux" aria-label="Permalink to &quot;ALT Linux&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yersinia</span></span></code></pre></div><h3 id="kali-linux" tabindex="-1">Kali Linux <a class="header-anchor" href="#kali-linux" aria-label="Permalink to &quot;Kali Linux&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yersinia</span></span></code></pre></div><h2 id="ссылки" tabindex="-1">Ссылки <a class="header-anchor" href="#ссылки" aria-label="Permalink to &quot;Ссылки&quot;">​</a></h2><ul><li><a href="https://packages.altlinux.org/ru/p11/srpms/yersinia/" target="_blank" rel="noreferrer">ALT Linux (srpms)</a></li><li><a href="https://www.kali.org/tools/yersinia/" target="_blank" rel="noreferrer">Kali Tools</a></li><li><a href="https://wiki.archlinux.org/title/Yersinia" target="_blank" rel="noreferrer">ArchWiki</a></li></ul><hr><p>title: &quot;Атаки на сетевое оборудование с Kali Linux&quot; source: &quot;<a href="https://habr.com/ru/articles/326968/" target="_blank" rel="noreferrer">https://habr.com/ru/articles/326968/</a>&quot; author:</p><ul><li>&quot;[[Лука Сафонов]]&quot; published: 2017-04-20 created: 2025-11-18 description: &quot;В данной статье мы рассмотрим актуальные атаки на сетевое оборудование и инструменты, доступные в популярном дистрибутиве Kali Linux для их проведения. Атакуем CISCO маршрутизатор В состав Kali...&quot; tags:</li><li>&quot;clippings&quot;</li></ul><hr><p><img src="https://habrastorage.org/r/w1560/getpro/habr/post_images/a30/c2d/676/a30c2d676b07070487c16f388a8cb659.png" alt="image"></p><p>В данной статье мы рассмотрим актуальные атаки на сетевое оборудование и инструменты, доступные в популярном дистрибутиве Kali Linux для их проведения.</p><h2 id="атакуем-cisco-маршрутизатор" tabindex="-1">Атакуем CISCO маршрутизатор <a class="header-anchor" href="#атакуем-cisco-маршрутизатор" aria-label="Permalink to &quot;Атакуем CISCO маршрутизатор&quot;">​</a></h2><p>В состав Kali Linux входит несколько инструментов, которые можно использовать для аудита оборудования CISCO. Список можно посмотреть в разделе Vulnerability Analysis — Cisco Tools:</p><p><img src="https://habrastorage.org/r/w1560/files/8f3/24f/967/8f324f9674ef4ac6a0a560989e679006.png" alt=""></p><p><strong>Cisco Audit Tool или CAT</strong><br> Используется для брутфорса пароля при выключенном режиме aaa-mode, брутфорса SNMP community-строк и проверки на уязвимость IOS History bug (<a href="https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-19981014-ios-hist" target="_blank" rel="noreferrer">https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-19981014-ios-hist</a>)</p><p>Пример использования:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>CAT -h 192.168.1.209 -w /root/cisco/wordlist/snmpcommunities -a /root/cisco/wordlist/password_list -i</span></span></code></pre></div><p><img src="https://habrastorage.org/r/w1560/files/174/0b4/d17/1740b4d172bc4edb8f8c8eab783fd596.png" alt=""></p><p><strong>Cisco Global Exploiter или CGE</strong><br> Используется для экслпутации известных уязвимостей. Нам доступно 14 атак:</p><p><img src="https://habrastorage.org/r/w1560/files/794/a2d/5f1/794a2d5f1c0b4f1e8e7080bbbc464eb7.png" alt=""></p><p>Пример использования:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>cge.pl 192.168.1.201 3</span></span></code></pre></div><p><img src="https://habrastorage.org/r/w1560/files/429/4ac/074/4294ac0749854e04abb0a677357c11c8.png" alt=""></p><p><strong>cisco-ocs</strong><br> Инструмент для автоматизации поиска устройств со стандартными значениями пароля для telnet и режима enable, который может искать устройства в диапазоне адресов. Может использоваться при сканировании больших сетей.</p><p>Пример использования:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>cisco-ocs 192.168.1.207 192.168.1.209</span></span></code></pre></div><p><img src="https://habrastorage.org/r/w1560/files/a02/13d/b00/a0213db009b04cf0ae5f8dd54862adca.png" alt=""></p><p><strong>cisco-torch</strong><br> Многофункциональный сканер уязвимостей для оборудования Cisco. Может сканировать несколько IP адресов за раз, подгружая из текстового файла. Запускать cisco-torch в Kali Linux следует, находясь в рабочей директории /usr/share/cisco-torch.</p><p>Пример использования:</p><p>Поиск доступных интерфейсов и протоколов и определение типа оборудования.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>cisco-torch -A 192.168.1.201</span></span></code></pre></div><p><img src="https://habrastorage.org/r/w1560/files/107/de9/053/107de905343949da846d69666c29a790.png" alt=""></p><p>Может использоваться для брутфорса паролей и SNMP community-строк.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>cisco-torch -s -b 192.168.1.209</span></span></code></pre></div><p>Для использования своего словаря, его нужно поместить в /usr/share/cisco-torch вместо файла password.txt</p><p><img src="https://habrastorage.org/r/w1560/files/4ff/fab/e5f/4fffabe5fed249ae923db4cfb0e943b1.png" alt=""></p><p><strong>copy-router-config.pl и merge-copy-config.pl</strong><br> Инструменты для загрузки текущей конфигурации маршрутизатора cisco при известной community-строке на свой tftp-сервер. В дальнейшем можно модифицировать конфигурацию и снова загрузить на сервер.</p><p>Пример использования:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>copy-router-config.pl 192.168.1.201 192.168.1.3 private</span></span></code></pre></div><p>Для автоматизации подобной атаки, где нас интересует только загрузка конфигурации на свой TFTP-сервер лучше воспользоваться модулем Metasploit auxiliary/scanner/snmp/cisco_config_tftp<br> Или NSE скриптом <a href="https://nmap.org/nsedoc/scripts/snmp-ios-config.html" target="_blank" rel="noreferrer">nmap snmp-ios-config</a>.</p><h2 id="атакуем-l2-протоколы" tabindex="-1">Атакуем L2 протоколы <a class="header-anchor" href="#атакуем-l2-протоколы" aria-label="Permalink to &quot;Атакуем L2 протоколы&quot;">​</a></h2><p><img src="https://habrastorage.org/r/w1560/files/090/bef/b73/090befb733234bdd86c13ed93af1e00f.png" alt=""></p><p>Yersinia — многофункциональный инструмент для атак на протоколы L2 (Data Link) уровня OSI.<br> Умеет проводить атаки на DHCP, STP, CDP, DTP, HSRP и другие.</p><p>Работать с Yersinia можно в нескольких режимах:</p><p>Запуск в режиме сервера и управление при помощи команд, похожих на cisco cli.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>yersinia -D</span></span>
<span class="line"><span>telnet 127.0.0.1 12000</span></span></code></pre></div><p>Логин и пароль root/root<br> Пароль для перехода в режим enable – tomac</p><ol><li>Запуск в интерактивном режиме</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>yersinia -I</span></span></code></pre></div><p><img src="https://habrastorage.org/r/w1560/files/34e/3a9/d93/34e3a9d93f244850bdec19ea9e7010a5.png" alt=""></p><p>Опции управления доступны по нажатии на клавишу h:</p><p><img src="https://habrastorage.org/r/w1560/files/59c/db8/ab1/59cdb8ab18c24783a39481a5accb380e.png" alt=""></p><ol><li>Графический интерфейс GTK</li></ol><p><img src="https://habrastorage.org/r/w1560/files/88d/404/8d8/88d4048d89624e069d156daaef32512d.png" alt=""></p><p>Графический интерфейс может работать нестабильно. В режиме сервера не поддерживает некоторые виды атак, вроде DHCP Rogue server. Так что, основным режимом запуска можно считать интерактивный режим.</p><h2 id="атакуем-dhcp-сервер" tabindex="-1">Атакуем DHCP сервер <a class="header-anchor" href="#атакуем-dhcp-сервер" aria-label="Permalink to &quot;Атакуем DHCP сервер&quot;">​</a></h2><p>В качестве примера продемонстрируем атаку на переполнение пула IP-адресов DHCP сервера. Данная атака может быть использована для выведения из строя корпоративного DHCP сервера и последующая его замещение поддельным, конфигудрация которого настроена таким образом, что весь трафик новых клиентов будет проходить через хост атакующего. Таким образом будет проведена одна из атак MitM.</p><p>На стороне атакующего можно выполнить скрипт nmap для обнаружения DHCP сервера в локальной сети.</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>nmap -n --script=broadcast-dhcp-discover</span></span></code></pre></div><p><img src="https://habrastorage.org/r/w1560/files/f0a/519/5df/f0a5195dffa34aa6966f13168193ddb6.png" alt=""></p><p>Теперь запускаем Yersinia в интерактивном режиме и переходим в режим DHCP выбрав его нажатием клавиши g.</p><p><img src="https://habrastorage.org/r/w1560/files/429/e2e/430/429e2e4302484cbc97b2b959069f1031.png" alt=""></p><p>Теперь в этом режиме будут видны все DHCP пакеты, полученные Yersinia.<br> Проверим список выданных адресов DHCP сервера до атаки:</p><p><img src="https://habrastorage.org/r/w1560/files/b3b/331/96e/b3b33196e09f4245999aab5a37063226.png" alt=""></p><p>Yersinia показывает DHCP пакеты, выловленные из сети:</p><p><img src="https://habrastorage.org/r/w1560/files/74b/9a0/f54/74b9a0f5468d4ecb9cf70825e29b7a4b.png" alt=""></p><p>Если выбрать пакет и нажать сочетание клавиш Shift+L то можно затем при помощи атаки RAW пересылать этот пакет в сеть, или модифицировать его при помощи нажатия клавиши e – переход в режим редактирования пакета.</p><p>При нажатии на клавишу x получаем список доступных атак:</p><p><img src="https://habrastorage.org/r/w1560/files/21b/02a/372/21b02a3721724d0e8593c536251885ab.png" alt=""></p><p>Выбираем 1</p><p>Видим, что начинает отправлять огромное количество DHCP Discover запросов:</p><p><img src="https://habrastorage.org/r/w1560/files/40e/fc2/809/40efc2809db246828488f3fd9bc2fea5.png" alt=""></p><p>Через некоторое время можно остановить атаку нажатием на клавиши L и затем Enter:</p><p><img src="https://habrastorage.org/r/w1560/files/c2e/9a5/1ab/c2e9a51ab406414289177f461e527f62.png" alt=""></p><p>Nmap больше не показывает доступных DHCP серверов в сети. Коропоративный DHCP сервер выведен из строя.</p><p><img src="https://habrastorage.org/r/w1560/files/976/339/727/97633972754d41c3a12476c29b0c4a51.png" alt=""></p><p>Проверим таблицу выданных IP-адресов на роутере:</p><p><img src="https://habrastorage.org/r/w1560/files/bbe/859/0fd/bbe8590fd73b4a2e8cd43d8dd6d71ad8.png" alt=""></p><p>Далее вы можете запустить атаку Rogue DHCP в Yersinia, либо при помощи модуля Metasploit или любым другим способом, чтобы провести MitM атаку.</p><p><img src="https://habrastorage.org/r/w1560/files/eef/fe1/f84/eeffe1f848ab4beab498c8bd7d421913.png" alt=""></p><p>Атаку на истощение пула IP адресов DHCP сервера можно так же провести при помощи инструмента <a href="https://github.com/kamorin/DHCPig" target="_blank" rel="noreferrer">DHCPig</a>. При помощи Yersinia можно проводить атаки и на другие популярные протоколы, такие как STP (Spanning Tree Protocol) и HSRP (Hot Standby Router Protocol), которые так же позволят вам прослушивать трафик в сети.</p><h2 id="атака-на-переполнение-cam-таблицы-коммутатора" tabindex="-1">Атака на переполнение CAM таблицы коммутатора. <a class="header-anchor" href="#атака-на-переполнение-cam-таблицы-коммутатора" aria-label="Permalink to &quot;Атака на переполнение CAM таблицы коммутатора.&quot;">​</a></h2><p>Еще одна атака, которая переполняет CAM таблицу коммутатора, хранящую список MAC адресов, работающих на определенном порту. Некоторые коммутаторы при ее переполнении начинают работать как хабы, рассылая пакеты на все порты, тем самым создавая идеальные условия для проведения атак класса MitM.</p><p>В Kali Linux для проведения данной атаки присутствует инструмент macof</p><p>Пример использования:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>macof -i eth0</span></span></code></pre></div><p>Где eth0 – интерфейс, к которому подключен коммутатор для атаки.</p><h2 id="защита" tabindex="-1">Защита <a class="header-anchor" href="#защита" aria-label="Permalink to &quot;Защита&quot;">​</a></h2><p>Для защиты от подобного рода атак производителями используются различные, обычно проприетарные, технологии. На коммутаторах Cisco следует активировать DHCP Snooping и PortSecutiy во избежание атак на протокол DHCP и CAM Overflow. Для защиты от атак на HSRP и прочие протоколы используются другие технологии. Всегда нужно помнить, что дорогостоящее сетевое оборудование после правильной настройки может существенно повысить безопасность сетевой инфраструктуры, в то же время недонастроенное или настроенное неправильно может само стать инструментом в руках злоумышленника и угрозой безопасности. Выявление уязвимостей сетевого оборудования при проведении <a href="https://red-delta.ru/pentest/" target="_blank" rel="noreferrer">тестирования на проникновение</a> и применение рекомендаций по результатам аудита помогает снизить риски взлома информационной системы злоумышленниками.</p>`,95)]))}const b=s(p,[["render",r]]);export{g as __pageData,b as default};
