import{_ as a,c as i,o as e,ag as t}from"./chunks/framework.D4Vqf8I7.js";const k=JSON.parse('{"title":"AmneziaWG","description":"","frontmatter":{},"headers":[],"relativePath":"docs/wi/amneziawg.md","filePath":"docs/wi/amneziawg.md","lastUpdated":1764236933000}'),n={name:"docs/wi/amneziawg.md"};function l(p,s,o,r,h,d){return e(),i("div",null,s[0]||(s[0]=[t('<h1 id="amneziawg" tabindex="-1">AmneziaWG <a class="header-anchor" href="#amneziawg" aria-label="Permalink to &quot;AmneziaWG&quot;">​</a></h1><p><img src="https://docs.amnezia.org/ru/assets/images/OG-5762ed4c3397cbaffc545cb422e052b1.png" alt=""></p><p><strong>Amnezia VPN</strong> — это бесплатный и открытый проект, разработанный российскими энтузиастами для обхода интернет-цензуры и защиты приватности пользователей в условиях усиления блокировок и DPI-анализа (глубокой инспекции трафика). В отличие от традиционных VPN-сервисов, Amnezia не предоставляет собственные серверы, а позволяет пользователям развернуть зашифрованный туннель на собственном VPS (виртуальном сервере) с использованием различных протоколов, включая OpenVPN, WireGuard, Shadowsocks, Cloak и другие. Особое внимание в проекте уделяется <strong>маскировке (обфускации) трафика</strong>, чтобы он выглядел как обычный HTTPS, SSH или другой легитимный трафик, что затрудняет его распознавание и блокировку со стороны провайдеров или государственных фильтров.</p><p><strong>AmneziaWG</strong> (Amnezia WireGuard) — это модифицированная версия популярного протокола <strong>WireGuard</strong>, расширенная функциями обфускации. Стандартный WireGuard, несмотря на высокую скорость и надёжность, легко детектируется по характерному UDP-трафику и часто блокируется в странах с жёсткой цензурой (например, в России, Иране, Китае). AmneziaWG решает эту проблему, добавляя <strong>псевдослучайные джиттеры (Jc, Jmin, Jmax)</strong> и <strong>уникальные заголовки (H1–H4)</strong>, а также параметры <strong>S1/S2</strong>, которые изменяют структуру пакетов, делая их похожими на обычный шум или легитимный трафик. При этом сохраняются все преимущества WireGuard: минимальная задержка, высокая производительность и простота настройки.</p><p>Важной особенностью AmneziaWG является наличие <strong>нативной поддержки на уровне ядра Linux</strong> через специальный kernel module. Это позволяет обрабатывать обфусцированный трафик напрямую в ядре, без необходимости запуска пользовательских демонов (вроде <code>amneziawg-go</code>), что повышает скорость, снижает потребление ресурсов и улучшает стабильность соединения. Конфигурация AmneziaWG выглядит почти как у обычного WireGuard, но включает дополнительные поля (<code>S1</code>, <code>S2</code>, <code>Jc</code>, <code>Jmin</code>, <code>Jmax</code>, <code>H1–H4</code>), которые <strong>должны быть одинаковыми на клиенте и сервере</strong> (за исключением параметров джиттера). Таким образом, AmneziaWG сочетает в себе <strong>высокую степень скрытности</strong> и <strong>производительность на уровне ядра</strong>, что делает его одним из самых эффективных решений для обхода современных систем блокировки.</p><h2 id="устнаовка" tabindex="-1">Устнаовка <a class="header-anchor" href="#устнаовка" aria-label="Permalink to &quot;Устнаовка&quot;">​</a></h2><ol><li>Устанавливаем необходимые пакеты (я тут их с перебором бахнул) ):</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> amnezia-vpn-client</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kernel-modules-amneziawg-6.12</span></span></code></pre></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> amnezia-vpn-service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> amneziawg-go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> amneziawg-tools</span></span></code></pre></div><ol start="2"><li>Настраиваем systemd-resolved (<a href="https://bugzilla.altlinux.org/52679" target="_blank" rel="noreferrer">https://bugzilla.altlinux.org/52679</a>)</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemd-networkd</span></span></code></pre></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --now</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemd-resolved</span></span></code></pre></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ln</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -sf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /run/systemd/resolve/stub-resolv.conf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/resolv.conf</span></span></code></pre></div><ol start="3"><li>Запускаем сервис:</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --now</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> AmneziaVPN</span></span></code></pre></div><ol start="4"><li><p>Перезагружаем систему.</p></li><li><p>Теперь входим в графическое приложение как обычно через меню приложений.</p></li></ol><h2 id="настроика-сервера-openvpn-wireguard-shadowsocks-ikev2-ipsec-и-cloak-l2tp-ipsec-pptp-openconnect-vpn-sstp-xray-reality-mpls-vless-l2tp-freelan-ssl-p2-помимо-vless-существуют-и-другие-защищенные-протоколы-такие-как-trojan-cloak-shadowtls-hysteria-hysteria2-mkcp-и-прочие" tabindex="-1">Настройка сервера OpenVPN, WireGuard, Shadowsocks, IKEv2/IPSec и Cloak, L2TP/IPSec, PPTP, OpenConnect VPN, SSTP, XRay Reality, MPLS, VLESS, L2TP, FreeLAN SSL P2. Помимо VLESS существуют и другие защищённые протоколы, такие как Trojan, Cloak, ShadowTLS, Hysteria/Hysteria2, mKCP и прочие... <a class="header-anchor" href="#настроика-сервера-openvpn-wireguard-shadowsocks-ikev2-ipsec-и-cloak-l2tp-ipsec-pptp-openconnect-vpn-sstp-xray-reality-mpls-vless-l2tp-freelan-ssl-p2-помимо-vless-существуют-и-другие-защищенные-протоколы-такие-как-trojan-cloak-shadowtls-hysteria-hysteria2-mkcp-и-прочие" aria-label="Permalink to &quot;Настройка сервера OpenVPN, WireGuard, Shadowsocks, IKEv2/IPSec и Cloak, L2TP/IPSec, PPTP, OpenConnect VPN, SSTP, XRay Reality, MPLS, VLESS, L2TP, FreeLAN SSL P2. Помимо VLESS существуют и другие защищённые протоколы, такие как Trojan, Cloak, ShadowTLS, Hysteria/Hysteria2, mKCP и прочие...&quot;">​</a></h2><p>Графическая панель 3X-UI X‑UI, Marzban, Hiddify — так называемые «панели», веб‑интерфейсы для прокси‑серверов. В их основе чаще всего используется тот же самый XRay. Изначально задуманы как более простой в установке и настройке вариант сервера для неподкованных пользователей. 3X-UI - легко устанавливается в Docker, сразу на английском с возможностью переключения на русский, имеет в себе все что надо - и главное, работает!</p><p>Однако, эти панели при неправильном управлении добавляют множество уязвимостей и могут привести к блокировке. Хоть в этой инструкции я и привожу пример настройки через панель 3X-UI и стараюсь её обезопасить, всё же рекомендую настраивать XRay напрямую через консоль.</p><hr><p>Попробовал запустить сервер с помощью Amnezia VPN Client, как собственно и описывается везде в инструкциях по амнезии. Установил XRay. С чем столкнуля? 1. В судоерс раскомментировал строку с wheel no passwd (возможно, можно и без нопассвд), также установил и запустил Докер. И он завёлся)</p><p>Просто дал Амнезии логин и пароль от рута, ну и, естественно, включил и настроил ссш для рута</p><p>А вот с подключением к серверу уже траблы пошли. У меня сервер на виртуалке в VM VB, а подключаюсь с хоста. Чёт крутится подключение, но не подключается. ВОЗМОЖНО, виной всему тот прикол, что у меня два сетевых адаптера (стандартный нат и внутренний адаптер хоста) ИЛИ всё из-за того, что у меня был выключен сервис AmneziaVPN)</p>',23)]))}const g=a(n,[["render",l]]);export{k as __pageData,g as default};
