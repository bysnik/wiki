import{_ as s,c as a,o as i,ag as o}from"./chunks/framework.D4Vqf8I7.js";const t="/wiki/assets/selinux.DvpFlUsp.png",g=JSON.parse('{"title":"Acess Control Lists","description":"","frontmatter":{},"headers":[],"relativePath":"docs/wi/altsp/45.sec_obj.md","filePath":"docs/wi/altsp/45.sec_obj.md","lastUpdated":1760528747000}'),l={name:"docs/wi/altsp/45.sec_obj.md"};function n(c,e,d,p,r,h){return i(),a("div",null,e[0]||(e[0]=[o(`<p>Операционная система должна предоставлять механизм управления фиксированными состояниями ключевых объектов безопасности системы, сохраняющий установленные права доступа к объектам файловой системы при обновлении пакетов.</p><hr><p><a href="https://www.altlinux.org/%D0%A3%D0%BF%D1%80%D0%B0%D0%B2%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5_%D0%BF%D1%80%D0%B0%D0%B2%D0%B0%D0%BC%D0%B8" target="_blank" rel="noreferrer">https://www.altlinux.org/Управление_правами</a><strong>chown, chmod, SUID, GUID, sticky bit, ACL, umask</strong></p><p><a href="https://metanit.com/os/linux/5.8.php" target="_blank" rel="noreferrer">https://metanit.com/os/linux/5.8.php</a></p><h1 id="acess-control-lists" tabindex="-1">Acess Control Lists <a class="header-anchor" href="#acess-control-lists" aria-label="Permalink to &quot;Acess Control Lists&quot;">​</a></h1><p>ACL или Access Control Lists (Списки контроля доступом) в Linux предоставляют еще одну возможность предоставлять разрешения нескольким пользователям и группам для одного и того же файла или каталога. ACL позволяют решить некоторые ограничения других общих инструментов управления разрешениями, в частности:</p><ul><li>У файла/каталога может быть только один пользователь-владелец и одна группа-владелец</li><li>Не работает наследование разрешений, чтобы разрешения каталога передавались его файлам и подкаталогам</li></ul><p>Списки ACL часто применяются к каталогам, чтобы гарантировать, что новые файлы, созданные в каталоге, автоматически получат необходимые разрешения. Для установки ACL применяется команда <code>setfacl</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">setfacl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [options] operation entity:entityname:permissions file</span></span></code></pre></div><p>Она принимает следующие компоненты:</p><ul><li><p><code>options</code>: с помощью необязательных опций позволяет управлять работой команды setfacl. Распространенные опции:</p><ul><li><code>-d</code>: устанавливает ACL по умолчанию. Это параметр ACL также наследуется подкаталогами и файлами.</li><li><code>-k</code>: удаляет список ACL по умолчанию.</li><li><code>-R</code>: рекурсивно применяет настройки ACL.</li></ul><p>ACL по умолчанию предназначен для новых файлов и не влияет на существующие файлы. Все новые файлы получат разрешения, установленные в ACL по умолчанию. Без опции <code>-d</code> команда <code>setfacl</code> работает только с существующими файлами. Чтобы убедиться, что все новые файлы получат желаемые настройки ACL, следует дважды использовать команду <code>setfacl</code>. Сначала с опцией <code>-d</code>, чтобы был установлен список ACL по умолчанию, а затем с опцией <code>-R</code> и без опции <code>-d</code>, чтобы позаботиться о существующих в данный момент файлах.</p></li><li><p><code>operation</code>: устанавливает, что надо сделать: добавить или удалить настройку ACL. Доступны следующие операции:</p><ul><li><code>--set</code>: используется для установки ACL. Стоит учитывать, что она заменит любой существующий ACL.</li><li><code>-m</code>: дополняет текущие настройки ACL, без полной замены.</li><li><code>-x</code>: удаляет существующий ACL.</li></ul></li><li><p><code>entity</code> и <code>entity name</code>: тип объекта имя объекта, которые определяют, для кого надо установить ACL. Существует два типа объектов: <code>u</code> для пользователя и <code>g</code> для группы. После указания типа объекта надо указать имя объекта.</p></li><li><p><code>permissions</code>: разрешения, которые надо установить с помощью списков управления доступом.</p></li><li><p><code>file</code>: имя файла или каталога, к которому надо применить списки ACL.</p></li></ul><p>Для получения информации о списках ACL применяется команда <code>getfacl</code>, которой передается имя файла/каталога:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getfacl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span></span></code></pre></div><p>В ОС Альт СП реализован механизм дискреционного разграничения доступа. Управление доступом применяется ко всем объектам, включая объекты файловой системы, базы данных, процессам и устройствам. Разграничение прав доступа осуществляется администратором в соответствие с типами операций (чтение, запись, исполнение). Реализуется такими средствами как <code>ACL</code>, <code>alterator-users</code>, <code>alterator-group</code>, <code>DAC</code>, <code>polkit</code>, <code>kiosk</code>.</p><p>Разделение полномочий (ролей) пользователей осуществляется администратором с помощью инструментов: <code>alterator-users</code>, <code>alterator-ldap-users</code>, <code>alterator-group</code>, <code>alterator-root</code>, <code>alterator-multiseat</code>, <code>chmod</code>, <code>chown</code>, <code>setfacl</code>, <code>chgrp</code>, <code>ACL</code>. Настройка проводится в соответствии с организационно-распорядительными документами оператора.</p><p>Назначение минимально необходимых прав и привилегий, разделение полномочий (ролей) пользователей осуществляется администратором с помощью инструментов управления учетными записями: <code>alterator-users</code>, <code>alterator-ldap-users</code>, <code>alterator-group</code>, <code>alterator-root</code>, <code>alterator-multiseat</code>, <code>chmod</code>, <code>chown</code>, <code>setfacl</code>, <code>chgrp</code>, <code>chow</code>, <code>DAC</code>. Настройка проводится в соответствии с организационно-распорядительными документами оператора.</p><p>В ОС каждый объект хранит свои права доступа, назначенные ему в соответствие с DAC (Discretionary Access Control)</p><h1 id="selinux-не-заработало-появилась-задача-183415" tabindex="-1">SELinux (Не заработало) (Появилась задача 183415) <a class="header-anchor" href="#selinux-не-заработало-появилась-задача-183415" aria-label="Permalink to &quot;SELinux (Не заработало) (Появилась задача 183415)&quot;">​</a></h1><p>SELinux (Security-Enhanced Linux) – это модуль ядра Linux, который предоставляет механизмы контроля доступа на основе политик безопасности. SELinux может быть важным инструментом для повышения безопасности вашей системы ALT Linux.</p><p>Чтобы проверить, активирован ли SELinux в вашей системе, используйте следующую команду:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>sestatus</span></span></code></pre></div><p>Если SELinux не активирован, вы можете включить его, отредактировав файл конфигурации:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>sudo nano /etc/selinux/config</span></span></code></pre></div><p>В этом файле измените значение SELINUX:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>SELINUX=permissive</span></span>
<span class="line"><span>SELINUXTYPE=strict</span></span></code></pre></div><p><code>enforcing</code> - SELinux security policy is enforced. <code>permissive</code> - SELinux prints warnings instead of enforcing. <code>disabled</code> - No SELinux policy is loaded.</p><p>SELINUXTYPE can take one of these four values: <code>targeted</code> - Only targeted network daemons are protected. <code>strict</code> - Full SELinux protection. <code>mls</code> - Full SELinux protection with Multi-Level Security <code>mcs</code> - Full SELinux protection with Multi-Category Security (<code>mls</code>, but only one sensitivity level)</p><p><a href="https://www.altlinux.org/Sl" target="_blank" rel="noreferrer">https://www.altlinux.org/Sl</a></p><h3 id="howto-get-working-selinux-alt-linux-policy" tabindex="-1">Howto get working SeLinux Alt Linux policy <a class="header-anchor" href="#howto-get-working-selinux-alt-linux-policy" aria-label="Permalink to &quot;Howto get working SeLinux Alt Linux policy&quot;">​</a></h3><h4 id="факты" tabindex="-1">Факты <a class="header-anchor" href="#факты" aria-label="Permalink to &quot;Факты&quot;">​</a></h4><p><code>libselinux</code> для своей работы требует <code>/proc</code> это требует учитывать для зачрученных приложений, которые могут отказывать работать по необяснимым причинам. Это относится к всяким родам службам, которые в ALT часто делают <code>chroot</code> с целью усиления защищенности.</p><h4 id="force-relabeling" tabindex="-1">Force relabeling <a class="header-anchor" href="#force-relabeling" aria-label="Permalink to &quot;Force relabeling&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">touch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /.autorelabel</span></span></code></pre></div><h4 id="update-grub-config" tabindex="-1">Update Grub config <a class="header-anchor" href="#update-grub-config" aria-label="Permalink to &quot;Update Grub config&quot;">​</a></h4><p>Update configuration GRUB&#39;s file: <code>/etc/sysconfig/grub2</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">GRUB_CMDLINE_LINUX_DEFAULT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;panic=30 quiet splash security=selinux selinux=1&#39;</span></span></code></pre></div><p>It is also possible to add:</p><ul><li><code>enforcing=1</code></li><li><code>log_buf_len=1M</code></li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">grub-mkconfig</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /boot/grub/grub.cfg</span></span></code></pre></div><h4 id="pam-configuration" tabindex="-1">PAM configuration <a class="header-anchor" href="#pam-configuration" aria-label="Permalink to &quot;PAM configuration&quot;">​</a></h4><ul><li>Add to <code>/etc/pam.d/newrole</code> before <code>pam_namespace.so</code> module</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">session</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        required</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pam_exec.so</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> debug</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/security/alt.newrole/helper</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/security/alt.newrole/config</span></span></code></pre></div><ul><li>Add to <code>/etc/pam.d/common-login</code>:</li></ul><p>The first session module <code>pam_selinux.so</code> close should be the first session rule</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">session</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    required</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     pam_selinux.so</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> close</span></span></code></pre></div><p>The last session module <code>pam_selinux.so</code> open should only be followed by sessions to be executed in the user context</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">session</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    required</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">     pam_selinux.so</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> open</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> verbose</span></span></code></pre></div><h4 id="reboot" tabindex="-1">Reboot <a class="header-anchor" href="#reboot" aria-label="Permalink to &quot;Reboot&quot;">​</a></h4><p>reboot system with enabled selinux</p><h4 id="install-policy" tabindex="-1">Install policy <a class="header-anchor" href="#install-policy" aria-label="Permalink to &quot;Install policy&quot;">​</a></h4><p>Install package selinux-policy-altlinux</p><h4 id="reboot-system-again" tabindex="-1">Reboot system again <a class="header-anchor" href="#reboot-system-again" aria-label="Permalink to &quot;Reboot system again&quot;">​</a></h4><p><img src="`+t+'" alt=""></p><p>Грузиться система не хочет, переходит в emergency mode Setting SELINUX context failed</p><p>| Продемонстрировать наличие соответствующих возможностей<br><br>Механизм control<br><br>Пример настройки через механизм control<br><br>Просмотреть температуру жёсткого диска можно также средствами консоль режима:<br><br>hddtemp — утилита мониторинга температуры жёсткого диска<br><br>Настройка прав доступа можно выполнить через control-механизм в консоли:<br><br>control | grep hdd<br><br>control hddtemp list<br><br>control hddtemp restricted<br><br>control hddtemp public<br><br>control hddtemp wheelonly<br><br>Настройка прав доступа к hddtemp через control-механизм средствами администрирования «Альт Домена» описана в разделе документации ⁠10.4.2. Управление control framework <a href="https://docs.altlinux.org/ru-RU/domain/10.4/html/group-policy/control.html" target="_blank" rel="noreferrer">https://docs.altlinux.org/ru-RU/domain/10.4/html/group-policy/control.html</a></p>',55)]))}const b=s(l,[["render",n]]);export{g as __pageData,b as default};
