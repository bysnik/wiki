import{_ as a,c as i,o as e,ag as t}from"./chunks/framework.D4Vqf8I7.js";const k=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"docs/disciplines/osis/p5.md","filePath":"docs/disciplines/osis/p5.md","lastUpdated":1759746635000}'),l={name:"docs/disciplines/osis/p5.md"};function n(h,s,o,p,d,c){return e(),i("div",null,s[0]||(s[0]=[t(`<h3 id="практическая-работа-по-теме" tabindex="-1">Практическая работа по теме: <a class="header-anchor" href="#практическая-работа-по-теме" aria-label="Permalink to &quot;Практическая работа по теме:&quot;">​</a></h3><p><strong>&quot;Подсистемы управления вводом/выводом Linux&quot;</strong><br><em>Для выполнения требуется доступ к Linux (рекомендуется использовать виртуальную машину или тестовый сервер).</em></p><hr><h2 id="блок-теории-краткое-резюме-предыдущего-занятия" tabindex="-1">Блок теории (краткое резюме предыдущего занятия) <a class="header-anchor" href="#блок-теории-краткое-резюме-предыдущего-занятия" aria-label="Permalink to &quot;Блок теории (краткое резюме предыдущего занятия)&quot;">​</a></h2><h3 id="основные-принципы-организации-ввода-вывода-в-linux" tabindex="-1">Основные принципы организации ввода-вывода в Linux <a class="header-anchor" href="#основные-принципы-организации-ввода-вывода-в-linux" aria-label="Permalink to &quot;Основные принципы организации ввода-вывода в Linux&quot;">​</a></h3><ol><li><p><strong>Физические принципы</strong>:</p><ul><li>Жесткие диски (HDD) состоят из пластин, головок, цилиндров и секторов.</li><li>Доступ к данным требует перемещения головки (seek time) и ожидания поворота диска (rotational latency).</li><li>SSD не имеют механических частей, поэтому seek time и rotational latency отсутствуют.</li></ul></li><li><p><strong>Логические принципы</strong>:</p><ul><li>Ядро Linux использует <strong>блочную подсистему</strong> для работы с устройствами.</li><li>Запросы к дискам обрабатываются через <strong>очереди запросов</strong> (request queue), где они сортируются и объединяются.</li><li><strong>VFS (Virtual File System)</strong> абстрагирует файловые системы, предоставляя единый интерфейс для приложений.</li></ul></li><li><p><strong>Алгоритмы планирования запросов</strong>:</p><ul><li><strong>CFQ (Completely Fair Queuing)</strong>: Распределяет квоты времени между процессами для &quot;справедливого&quot; доступа к диску. Подходит для HDD.</li><li><strong>Deadline</strong>: Гарантирует обработку запросов в течение заданного времени (deadline), минимизируя голодание процессов. Оптимален для серверов.</li><li><strong>NOOP</strong>: Простая FIFO-очередь без сортировки. Используется для SSD или виртуальных дисков (меньше накладных расходов).</li><li><strong>kyber/mq-deadline</strong>: Современные планировщики для многопоточных систем (актуально для новых ядер Linux).</li></ul></li><li><p><strong>Пути в sysfs</strong>:<br> Параметры подсистемы ввода-вывода настраиваются через виртуальную файловую систему <code>/sys/block/</code>.</p></li></ol><hr><h2 id="практическая-часть" tabindex="-1">Практическая часть <a class="header-anchor" href="#практическая-часть" aria-label="Permalink to &quot;Практическая часть&quot;">​</a></h2><p><em>Преподаватель демонстрирует действия, студенты повторяют в своих терминалах.</em></p><hr><h3 id="задание-1-просмотр-текущего-планировщика-ввода-вывода" tabindex="-1">Задание 1. Просмотр текущего планировщика ввода-вывода <a class="header-anchor" href="#задание-1-просмотр-текущего-планировщика-ввода-вывода" aria-label="Permalink to &quot;Задание 1. Просмотр текущего планировщика ввода-вывода&quot;">​</a></h3><p><strong>Цель</strong>: Узнать, какой планировщик используется для диска.</p><h4 id="шаги" tabindex="-1">Шаги: <a class="header-anchor" href="#шаги" aria-label="Permalink to &quot;Шаги:&quot;">​</a></h4><ol><li><p>Определите имя диска (обычно <code>sda</code>, <code>nvme0n1</code>):</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">lsblk</span></span></code></pre></div><p><em>Пример вывода:</em></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>NAME        MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT</span></span>
<span class="line"><span>sda           8:0    0   100G  0 disk </span></span>
<span class="line"><span>├─sda1        8:1    0   512M  0 part /boot</span></span>
<span class="line"><span>└─sda2        8:2    0  99.5G  0 part /</span></span></code></pre></div></li><li><p>Проверьте текущий планировщик для диска <code>sda</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /sys/block/sda/queue/scheduler</span></span></code></pre></div><p><em>Пример вывода:</em></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[mq-deadline] kyber bfq none</span></span></code></pre></div><ul><li>Квадратные скобки <code>[ ]</code> указывают активный планировщик.</li></ul></li></ol><h4 id="вопрос-для-студентов" tabindex="-1">Вопрос для студентов: <a class="header-anchor" href="#вопрос-для-студентов" aria-label="Permalink to &quot;Вопрос для студентов:&quot;">​</a></h4><blockquote><p>Почему для SSD рекомендуется использовать <code>NOOP</code> или <code>mq-deadline</code>, а не <code>CFQ</code>?</p></blockquote><hr><h3 id="задание-2-смена-планировщика-ввода-вывода" tabindex="-1">Задание 2. Смена планировщика ввода-вывода <a class="header-anchor" href="#задание-2-смена-планировщика-ввода-вывода" aria-label="Permalink to &quot;Задание 2. Смена планировщика ввода-вывода&quot;">​</a></h3><p><strong>Цель</strong>: Изменить планировщик на <code>deadline</code> и проверить результат.</p><h4 id="шаги-1" tabindex="-1">Шаги: <a class="header-anchor" href="#шаги-1" aria-label="Permalink to &quot;Шаги:&quot;">​</a></h4><ol><li><p>Установите планировщик <code>deadline</code> для диска <code>sda</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> deadline</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tee</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /sys/block/sda/queue/scheduler</span></span></code></pre></div><p><em>Примечание:</em> Требуются права <code>root</code>.</p></li><li><p>Убедитесь, что планировщик изменился:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /sys/block/sda/queue/scheduler</span></span></code></pre></div><p><em>Ожидаемый вывод:</em></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[deadline] mq-deadline kyber bfq none</span></span></code></pre></div></li></ol><h4 id="важно" tabindex="-1">Важно! <a class="header-anchor" href="#важно" aria-label="Permalink to &quot;Важно!&quot;">​</a></h4><ul><li>Для SSD смена на <code>noop</code> может улучшить производительность:<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> noop</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tee</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /sys/block/sda/queue/scheduler</span></span></code></pre></div></li></ul><hr><h3 id="задание-3-мониторинг-активности-диска-с-помощью-iostat" tabindex="-1">Задание 3. Мониторинг активности диска с помощью <code>iostat</code> <a class="header-anchor" href="#задание-3-мониторинг-активности-диска-с-помощью-iostat" aria-label="Permalink to &quot;Задание 3. Мониторинг активности диска с помощью \`iostat\`&quot;">​</a></h3><p><strong>Цель</strong>: Анализировать статистику ввода-вывода в реальном времени.</p><h4 id="шаги-2" tabindex="-1">Шаги: <a class="header-anchor" href="#шаги-2" aria-label="Permalink to &quot;Шаги:&quot;">​</a></h4><ol><li><p>Установите утилиту <code>sysstat</code> (если не установлена):</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sysstat</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # Для Debian/Ubuntu</span></span></code></pre></div></li><li><p>Запустите мониторинг каждые 2 секунды:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">iostat</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -x</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span></code></pre></div><p><em>Ключевые параметры:</em></p><ul><li><code>%util</code> — загрузка диска (100% = дисковый ствол).</li><li><code>await</code> — среднее время ожидания запроса (мс).</li><li><code>svctm</code> — среднее время обслуживания запроса (мс).</li></ul></li><li><p>Выполните операцию с диском (например, копирование файла) и наблюдайте за изменениями:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> if=/dev/zero</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> of=testfile</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bs=1G</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> count=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span></code></pre></div></li></ol><h4 id="вопрос-для-студентов-1" tabindex="-1">Вопрос для студентов: <a class="header-anchor" href="#вопрос-для-студентов-1" aria-label="Permalink to &quot;Вопрос для студентов:&quot;">​</a></h4><blockquote><p>Как изменятся значения <code>await</code> и <code>%util</code> при использовании <code>deadline</code> по сравнению с <code>cfq</code>?</p></blockquote><hr><h3 id="задание-4-анализ-параметров-очереди-запросов" tabindex="-1">Задание 4. Анализ параметров очереди запросов <a class="header-anchor" href="#задание-4-анализ-параметров-очереди-запросов" aria-label="Permalink to &quot;Задание 4. Анализ параметров очереди запросов&quot;">​</a></h3><p><strong>Цель</strong>: Изучить настройки очереди ввода-вывода.</p><h4 id="шаги-3" tabindex="-1">Шаги: <a class="header-anchor" href="#шаги-3" aria-label="Permalink to &quot;Шаги:&quot;">​</a></h4><ol><li><p>Просмотрите максимальный размер очереди (в секторах):</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /sys/block/sda/queue/max_sectors_kb</span></span></code></pre></div></li><li><p>Узнайте текущую глубину очереди:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /sys/block/sda/queue/nr_requests</span></span></code></pre></div></li><li><p>Проверьте время &quot;ожидания&quot; для планировщика <code>deadline</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /sys/block/sda/queue/iosched/read_expire</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /sys/block/sda/queue/iosched/write_expire</span></span></code></pre></div><p><em>По умолчанию:</em></p><ul><li><code>read_expire = 100</code> мс (макс. задержка для чтения),</li><li><code>write_expire = 5000</code> мс (макс. задержка для записи).</li></ul></li></ol><h4 id="эксперимент" tabindex="-1">Эксперимент: <a class="header-anchor" href="#эксперимент" aria-label="Permalink to &quot;Эксперимент:&quot;">​</a></h4><ul><li>Увеличьте <code>read_expire</code> до 500 мс и сравните задержки при чтении:<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 500</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tee</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /sys/block/sda/queue/iosched/read_expire</span></span></code></pre></div></li></ul><hr><h3 id="задание-5-тест-производительности-с-разными-планировщиками-опционально" tabindex="-1">Задание 5. Тест производительности с разными планировщиками (опционально) <a class="header-anchor" href="#задание-5-тест-производительности-с-разными-планировщиками-опционально" aria-label="Permalink to &quot;Задание 5. Тест производительности с разными планировщиками (опционально)&quot;">​</a></h3><p><strong>Цель</strong>: Сравнить скорость работы диска с <code>deadline</code> и <code>noop</code>.</p><h4 id="шаги-4" tabindex="-1">Шаги: <a class="header-anchor" href="#шаги-4" aria-label="Permalink to &quot;Шаги:&quot;">​</a></h4><ol><li><p>Установите утилиту <code>fio</code> (Flexible I/O Tester):</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fio</span></span></code></pre></div></li><li><p>Запустите тест с планировщиком <code>deadline</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fio</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --name=randread</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --ioengine=libaio</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --rw=randread</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --bs=4k</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --numjobs=4</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --size=256M</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --runtime=30</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --time_based</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --group_reporting</span></span></code></pre></div></li><li><p>Повторите тест для <code>noop</code> (предварительно сменив планировщик, см. Задание 2).</p></li><li><p>Сравните результаты (IOPS, latency).</p></li></ol><hr><h2 id="контрольные-вопросы" tabindex="-1">Контрольные вопросы <a class="header-anchor" href="#контрольные-вопросы" aria-label="Permalink to &quot;Контрольные вопросы&quot;">​</a></h2><ol><li><p>Какой планировщик лучше использовать для HDD в системе с высокой нагрузкой на запись?<br><strong>Ответ</strong>: <code>deadline</code> (минимизирует задержки для записи).</p></li><li><p>Почему для SSD не рекомендуется использовать <code>cfq</code>?<br><strong>Ответ</strong>: <code>cfq</code> оптимизирован для HDD, из-за ненужной сортировки запросов снижает производительность SSD.</p></li><li><p>Как проверить, поддерживает ли ваше устройство многопоточную очередь (multiqueue)?<br><strong>Ответ</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ls</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /sys/block/sda/mq</span></span></code></pre></div><p>Если каталог существует — поддерживается.</p></li></ol><hr><h2 id="рекомендации" tabindex="-1">Рекомендации <a class="header-anchor" href="#рекомендации" aria-label="Permalink to &quot;Рекомендации&quot;">​</a></h2><ul><li>Все изменения в <code>/sys/block/</code> <strong>временные</strong> (сбрасываются после перезагрузки). Для постоянной настройки используйте <code>udev</code>-правила или параметры ядра в <code>/etc/default/grub</code>.</li><li>При работе с реальными серверами тестируйте планировщики в нерабочее время.</li></ul><p><strong>Готово!</strong> После выполнения работы студенты должны понимать, как управлять подсистемой ввода-вывода Linux и выбирать оптимальные настройки для разных типов дисков.</p>`,49)]))}const g=a(l,[["render",n]]);export{k as __pageData,g as default};
