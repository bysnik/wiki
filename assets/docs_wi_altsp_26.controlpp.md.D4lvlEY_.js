import{_ as i,c as a,o as t,ag as e}from"./chunks/framework.D4Vqf8I7.js";const l="/wiki/assets/control__dig.DVtLz0Uq.png",g=JSON.parse('{"title":"Принцип работы control++","description":"","frontmatter":{},"headers":[],"relativePath":"docs/wi/altsp/26.controlpp.md","filePath":"docs/wi/altsp/26.controlpp.md","lastUpdated":1755088583000}'),n={name:"docs/wi/altsp/26.controlpp.md"};function p(o,s,c,d,h,r){return t(),a("div",null,s[0]||(s[0]=[e(`<p>Операционная система должна предоставлять администратору возможность ограничения действий пользователей в консолях.</p><hr><p>Документ [[ЛКНВ.11100-01 99 03 Руководство по комплексу средств защиты.pdf]], стр 199-207 программа [[control++]] <a href="https://www.altlinux.org/Control%2B%2B" target="_blank" rel="noreferrer">https://www.altlinux.org/Control%2B%2B</a></p><p>Стенд: Межсетевой экран + ограничение действий в консоли</p><p>В ОС Альт СП механизм контроля запуска компонентов программного обеспечения реализуется при помощи программы control++.</p><h1 id="принцип-работы-control" tabindex="-1">Принцип работы control++ <a class="header-anchor" href="#принцип-работы-control" aria-label="Permalink to &quot;Принцип работы control++&quot;">​</a></h1><p>При установке режима ограничений и прав формируются данные, обеспечивающие возможность возврата к исходному состоянию при сбросе текущего режима. Также при каждой установке режима сохраняется описание установленного режима.</p><p>При каждой установке режима происходит предварительный сброс текущего режима.</p><p>При запуске программы для переключения режима, например, <code>control++ &lt;название_режима&gt;</code>, которому соответствует вариант ограничений <code>ulims_x</code>, вариант прав <code>perm_y</code> и сценарий <code>sh_z</code>, программа попытается скопировать файл <code>/etc/control++/ulimits/ulims_x</code> в каталог <code>/etc/security/limits.d/</code> (таким образом, чтобы он имел наивысший приоритет среди уже имеющихся файлов ограничений), попытается применить права на файлы в соответствии с описанием в <code>/etc/control++/permissions/perm_y</code> и запустить сценарий <code>/etc/control++/permissions/sh_z/do</code>. В случае невозможности осуществления какой-либо из операций будет выведено сообщение об ошибке. Если какой-то из параметров не указан (например, название сценария оболочки), то соответствующая операция не будет выполняться.</p><p>При проверке соответствия текущего состояния системы параметрам установленного ранее режима осуществляется:</p><ul><li>сравнение содержимого наиболее приоритетного ulimits-файла из каталога <code>/etc/security/limits.d/</code> с содержимым ulimits-файла, сохраненного при установке данного режима;</li><li>сравнение текущих режимов всех файлов, затронутых установкой данного режима, с текущим описанием прав, которое носит название установленного подрежима;</li><li>запуск test-сценария данного режима, при наличии такого сценария (его отсутствие не считается ошибкой).</li></ul><p>Если какой-то из файлов, перечисленных в описании прав для данного режима, отсутствует в системе, то установка данного режима не будет считаться по этой причине неуспешной. Также, при проверке соответствия режима, права отсутствующего файла не считаются несоответствующими правам, указанным в описании режима.</p><h1 id="пример-создание-черного-списка" tabindex="-1">Пример: создание черного списка <a class="header-anchor" href="#пример-создание-черного-списка" aria-label="Permalink to &quot;Пример: создание черного списка&quot;">​</a></h1><p>Для настройки черного и (или) белого списка отредактировать содержимое файла <code>/etc/control++/control++.conf</code>, включив описание соответствующих режимов (<code>wl</code> и <code>blacklist</code>), каждый из которых имеет тип <code>permissions</code> (под названием <code>wl</code> и <code>bl</code>):</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[wl] </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">permissions</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[blacklist] </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">permissions</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bl</span></span></code></pre></div><p>Пример создания конфигурационного файла черного списка <code>/etc/control++/permissions/bl</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[blacklist] </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">path</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;/etc/control++/black_list&quot;</span></span></code></pre></div><p>Далее необходимо сформировать черный список. Например, чтобы занести в черный список программу <code>dig</code>, необходимо создать файл <code>/etc/control++/black_list </code> и добавить в него строку:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/usr/bin/dig</span></span></code></pre></div><p>Просмотреть список доступных режимов:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">control++</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Available modes:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># wl </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># blacklist</span></span></code></pre></div><p>Установка режима применения черного списка (<code>blacklist</code>):</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">control++</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> blacklist</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Setting &#39;blacklist&#39; mode for the &#39;permissions&#39; unit..............................[DONE] </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Mode set OK </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Current mode is &#39;blacklist&#39;</span></span></code></pre></div><p>После установки данного режима, пользователю будет запрещен запуск программ, перечисленных в файле <code>/etc/control++/black_list</code> (в примере <code>dig</code>).</p><p>Для сброса существующего режима следует выполнить команду:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">control++</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --reset</span></span></code></pre></div><p><img src="`+l+'" alt=""></p>',27)]))}const b=i(n,[["render",p]]);export{g as __pageData,b as default};
