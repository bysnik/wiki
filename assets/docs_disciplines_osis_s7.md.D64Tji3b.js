import{_ as i,c as a,o as t,ag as h}from"./chunks/framework.D4Vqf8I7.js";const g=JSON.parse('{"title":"–°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞: –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã –ø–∞–∫–µ—Ç–æ–≤ tcpdump –∏ tshark –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ GNU/Linux","description":"","frontmatter":{},"headers":[],"relativePath":"docs/disciplines/osis/s7.md","filePath":"docs/disciplines/osis/s7.md","lastUpdated":1760972908000}'),n={name:"docs/disciplines/osis/s7.md"};function l(p,s,e,k,d,r){return t(),a("div",null,s[0]||(s[0]=[h(`<h1 id="—Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è-—Ä–∞–±–æ—Ç–∞-–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã-–ø–∞–∫–µ—Ç–æ–≤-tcpdump-–∏-tshark-–≤-–∫–æ–Ω—Ç–µ–∫—Å—Ç–µ-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–∏-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏-gnu-linux" tabindex="-1"><strong>–°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞: –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã –ø–∞–∫–µ—Ç–æ–≤ <code>tcpdump</code> –∏ <code>tshark</code> –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ GNU/Linux</strong> <a class="header-anchor" href="#—Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è-—Ä–∞–±–æ—Ç–∞-–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã-–ø–∞–∫–µ—Ç–æ–≤-tcpdump-–∏-tshark-–≤-–∫–æ–Ω—Ç–µ–∫—Å—Ç–µ-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–∏-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏-gnu-linux" aria-label="Permalink to &quot;**–°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞: –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã –ø–∞–∫–µ—Ç–æ–≤ \`tcpdump\` –∏ \`tshark\` –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ GNU/Linux**&quot;">‚Äã</a></h1><hr><h2 id="–±–ª–æ–∫-—Ç–µ–æ—Ä–∏–∏-–∞–Ω–∞–ª–∏–∑-—Å–µ—Ç–µ–≤–æ–≥–æ-—Ç—Ä–∞—Ñ–∏–∫–∞-–∫–∞–∫-–æ—Å–Ω–æ–≤–∞-–∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏" tabindex="-1"><strong>–ë–ª–æ–∫ —Ç–µ–æ—Ä–∏–∏: –ê–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –∫–∞–∫ –æ—Å–Ω–æ–≤–∞ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</strong> <a class="header-anchor" href="#–±–ª–æ–∫-—Ç–µ–æ—Ä–∏–∏-–∞–Ω–∞–ª–∏–∑-—Å–µ—Ç–µ–≤–æ–≥–æ-—Ç—Ä–∞—Ñ–∏–∫–∞-–∫–∞–∫-–æ—Å–Ω–æ–≤–∞-–∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏" aria-label="Permalink to &quot;**–ë–ª–æ–∫ —Ç–µ–æ—Ä–∏–∏: –ê–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –∫–∞–∫ –æ—Å–Ω–æ–≤–∞ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**&quot;">‚Äã</a></h2><h3 id="_1-–∑–∞—á–µ–º-–Ω—É–∂–Ω—ã-–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã-–ø–∞–∫–µ—Ç–æ–≤" tabindex="-1"><strong>1. –ó–∞—á–µ–º –Ω—É–∂–Ω—ã –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã –ø–∞–∫–µ—Ç–æ–≤?</strong> <a class="header-anchor" href="#_1-–∑–∞—á–µ–º-–Ω—É–∂–Ω—ã-–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã-–ø–∞–∫–µ—Ç–æ–≤" aria-label="Permalink to &quot;**1. –ó–∞—á–µ–º –Ω—É–∂–Ω—ã –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã –ø–∞–∫–µ—Ç–æ–≤?**&quot;">‚Äã</a></h3><p>–°–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫ ‚Äî —ç—Ç–æ &quot;–∫—Ä–æ–≤–µ–Ω–æ—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞&quot; –ª—é–±–æ–π –ò–¢-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –ê–Ω–∞–ª–∏–∑ –ø–∞–∫–µ—Ç–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç:</p><ul><li><strong>–û–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å –∞—Ç–∞–∫–∏</strong> (—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤, DDoS, MITM).</li><li><strong>–î–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö</strong> (–Ω–µ–æ–±—ã—á–Ω—ã–π –∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫).</li><li><strong>–ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–æ–≤</strong>.</li><li><strong>–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π</strong> (–Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–æ–ª–∏, —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã).</li><li><strong>–†–∞—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã</strong> (forensic analysis).</li></ul><blockquote><p>‚ö†Ô∏è <strong>–í–∞–∂–Ω–æ!</strong> –ó–∞—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —è–≤–ª—è–µ—Ç—Å—è –Ω–∞—Ä—É—à–µ–Ω–∏–µ–º –∑–∞–∫–æ–Ω–∞ –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å—Ç—Ä–∞–Ω. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã <strong>—Ç–æ–ª—å–∫–æ –≤ —Ä–∞–º–∫–∞—Ö —ç—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ö–∞–∫–∏–Ω–≥–∞ –∏–ª–∏ –Ω–∞ —Å–≤–æ–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö</strong>.</p></blockquote><hr><h3 id="_2-tcpdump-‚Äî-–∫–æ–Ω—Å–æ–ª—å–Ω—ã–∏-–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä-—Ç—Ä–∞—Ñ–∏–∫–∞" tabindex="-1"><strong>2. <code>tcpdump</code> ‚Äî –∫–æ–Ω—Å–æ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä —Ç—Ä–∞—Ñ–∏–∫–∞</strong> <a class="header-anchor" href="#_2-tcpdump-‚Äî-–∫–æ–Ω—Å–æ–ª—å–Ω—ã–∏-–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä-—Ç—Ä–∞—Ñ–∏–∫–∞" aria-label="Permalink to &quot;**2. \`tcpdump\` ‚Äî –∫–æ–Ω—Å–æ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä —Ç—Ä–∞—Ñ–∏–∫–∞**&quot;">‚Äã</a></h3><h4 id="–∫–ª—é—á–µ–≤—ã–µ-–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏" tabindex="-1"><strong>–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏</strong> <a class="header-anchor" href="#–∫–ª—é—á–µ–≤—ã–µ-–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏" aria-label="Permalink to &quot;**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**&quot;">‚Äã</a></h4><ul><li><strong>–õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π</strong>: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ—Å—É—Ä—Å–∞–º.</li><li><strong>–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –ª–µ—Ç—É</strong>: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ BPF (Berkeley Packet Filter).</li><li><strong>–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª</strong>: –î–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.</li><li><strong>–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏</strong>: Suricata, Zeek, Wireshark.</li></ul><h4 id="–æ—Å–Ω–æ–≤–Ω—ã–µ-–æ–ø—Ü–∏–∏" tabindex="-1"><strong>–û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø—Ü–∏–∏</strong> <a class="header-anchor" href="#–æ—Å–Ω–æ–≤–Ω—ã–µ-–æ–ø—Ü–∏–∏" aria-label="Permalink to &quot;**–û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø—Ü–∏–∏**&quot;">‚Äã</a></h4><table tabindex="0"><thead><tr><th>–û–ø—Ü–∏—è</th><th>–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ</th><th>–ü—Ä–∏–º–µ—Ä</th></tr></thead><tbody><tr><td><code>-i</code></td><td>–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å</td><td><code>tcpdump -i eth0</code></td></tr><tr><td><code>-w</code></td><td>–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª</td><td><code>tcpdump -w capture.pcap</code></td></tr><tr><td><code>-r</code></td><td>–ü—Ä–æ—á–∏—Ç–∞—Ç—å –∏–∑ —Ñ–∞–π–ª–∞</td><td><code>tcpdump -r capture.pcap</code></td></tr><tr><td><code>-nn</code></td><td>–ù–µ —Ä–∞–∑—Ä–µ—à–∞—Ç—å –∏–º–µ–Ω–∞</td><td><code>tcpdump -nn port 53</code></td></tr><tr><td><code>-c</code></td><td>–õ–∏–º–∏—Ç –ø–∞–∫–µ—Ç–æ–≤</td><td><code>tcpdump -c 10 host 192.168.1.1</code></td></tr><tr><td><code>-s</code></td><td>–†–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞</td><td><code>tcpdump -s 0</code> (–ø–æ–ª–Ω—ã–π –¥–∞–º–ø)</td></tr></tbody></table><h4 id="–ø—Ä–∏–º–µ—Ä—ã-—Ñ–∏–ª—å—Ç—Ä–æ–≤-bpf" tabindex="-1"><strong>–ü—Ä–∏–º–µ—Ä—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ BPF</strong> <a class="header-anchor" href="#–ø—Ä–∏–º–µ—Ä—ã-—Ñ–∏–ª—å—Ç—Ä–æ–≤-bpf" aria-label="Permalink to &quot;**–ü—Ä–∏–º–µ—Ä—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ BPF**&quot;">‚Äã</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># –¢—Ä–∞—Ñ–∏–∫ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É IP</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tcpdump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> host</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.1.100</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># DNS-–∑–∞–ø—Ä–æ—Å—ã</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tcpdump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 53</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># HTTP-—Ç—Ä–∞—Ñ–∏–∫ (–Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tcpdump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 80</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># SYN-—Ñ–ª—É–¥ (–∞—Ç–∞–∫–∞)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tcpdump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;tcp[13] &amp; 2 != 0&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> src</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10.0.0.5</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># –¢—Ä–∞—Ñ–∏–∫ –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –ø–æ—Ä—Ç—É</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tcpdump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dst</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 22</span></span></code></pre></div><h4 id="–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ-–≤-–∏–±" tabindex="-1"><strong>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –ò–ë</strong> <a class="header-anchor" href="#–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ-–≤-–∏–±" aria-label="Permalink to &quot;**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –ò–ë**&quot;">‚Äã</a></h4><ul><li><p><strong>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ä—Ç–æ–≤</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tcpdump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;tcp[13] == 2&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> awk</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;{print $3}&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> sort</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> uniq</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span></span></code></pre></div><p>–ï—Å–ª–∏ –æ–¥–∏–Ω IP –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º–Ω–æ–≥–æ SYN-–ø–∞–∫–µ—Ç–æ–≤ ‚Äî –≤–µ—Ä–æ—è—Ç–µ–Ω port scan.</p></li><li><p><strong>–ü–æ–∏—Å–∫ —É—Ç–µ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tcpdump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -A</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> eth0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;tcp port 80 and (http contains &quot;password&quot; or http contains &quot;token&quot;)&#39;</span></span></code></pre></div></li></ul><hr><h3 id="_3-tshark-‚Äî-–º–æ—â–Ω—ã–∏-–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä-–æ—Ç-wireshark" tabindex="-1"><strong>3. <code>tshark</code> ‚Äî –º–æ—â–Ω—ã–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –æ—Ç Wireshark</strong> <a class="header-anchor" href="#_3-tshark-‚Äî-–º–æ—â–Ω—ã–∏-–∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä-–æ—Ç-wireshark" aria-label="Permalink to &quot;**3. \`tshark\` ‚Äî –º–æ—â–Ω—ã–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –æ—Ç Wireshark**&quot;">‚Äã</a></h3><h4 id="–∫–ª—é—á–µ–≤—ã–µ-–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø–µ—Ä–µ–¥-tcpdump" tabindex="-1"><strong>–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–µ—Ä–µ–¥ tcpdump</strong> <a class="header-anchor" href="#–∫–ª—é—á–µ–≤—ã–µ-–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞-–ø–µ—Ä–µ–¥-tcpdump" aria-label="Permalink to &quot;**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–µ—Ä–µ–¥ tcpdump**&quot;">‚Äã</a></h4><ul><li><strong>–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤</strong>: –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ TLS, HTTP/2, DNSSEC.</li><li><strong>–î–∏—Å–ø–ª–µ–π-—Ñ–∏–ª—å—Ç—Ä—ã</strong>: –ö–∞–∫ –≤ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º Wireshark (<code>http.request.method == &quot;POST&quot;</code>).</li><li><strong>–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</strong>: –í JSON, CSV, XML.</li><li><strong>Lua-—Å–∫—Ä–∏–ø—Ç—ã</strong>: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞.</li></ul><h4 id="–æ—Å–Ω–æ–≤–Ω—ã–µ-–æ–ø—Ü–∏–∏-1" tabindex="-1"><strong>–û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø—Ü–∏–∏</strong> <a class="header-anchor" href="#–æ—Å–Ω–æ–≤–Ω—ã–µ-–æ–ø—Ü–∏–∏-1" aria-label="Permalink to &quot;**–û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø—Ü–∏–∏**&quot;">‚Äã</a></h4><table tabindex="0"><thead><tr><th>–û–ø—Ü–∏—è</th><th>–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ</th><th>–ü—Ä–∏–º–µ—Ä</th></tr></thead><tbody><tr><td><code>-i</code></td><td>–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å</td><td><code>tshark -i wlan0</code></td></tr><tr><td><code>-Y</code></td><td>–î–∏—Å–ø–ª–µ–π-—Ñ–∏–ª—å—Ç—Ä</td><td><code>tshark -Y &quot;http&quot;</code></td></tr><tr><td><code>-T</code></td><td>–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞</td><td><code>tshark -T json</code></td></tr><tr><td><code>-e</code></td><td>–ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –ø–æ–ª–µ</td><td><code>tshark -e ip.src -e http.host</code></td></tr><tr><td><code>-qz</code></td><td>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</td><td><code>tshark -qz io,phs</code></td></tr></tbody></table><h4 id="–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è" tabindex="-1"><strong>–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</strong> <a class="header-anchor" href="#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è" aria-label="Permalink to &quot;**–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**&quot;">‚Äã</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># –ê–Ω–∞–ª–∏–∑ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tshark</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> eth0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fields</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http.host</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http.request.uri</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># –ü–æ–∏—Å–∫ –ø–æ–ø—ã—Ç–æ–∫ SQL-–∏–Ω—ä–µ–∫—Ü–∏–π</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tshark</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;http contains &quot;SELECT * FROM&quot;&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> json</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tshark</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -qz</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> io,phs</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># –ê–Ω–∞–ª–∏–∑ TLS-—Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏–π (—É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –≤–µ—Ä—Å–∏–∏)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tshark</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;tls.handshake&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fields</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tls.handshake.version</span></span></code></pre></div><h4 id="–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ-–≤-–∏–±-1" tabindex="-1"><strong>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –ò–ë</strong> <a class="header-anchor" href="#–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ-–≤-–∏–±-1" aria-label="Permalink to &quot;**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –ò–ë**&quot;">‚Äã</a></h4><ul><li><p><strong>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É—è–∑–≤–∏–º—ã—Ö SSL/TLS-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tshark</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;tls.handshake.ciphersuite == 0x0035&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # –ü–æ–∏—Å–∫ SSLv3 (—É—è–∑–≤–∏–º –∫ POODLE)</span></span></code></pre></div></li><li><p><strong>–ê–Ω–∞–ª–∏–∑ DNS-—Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tshark</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;dns.qry.name contains &quot;malicious&quot;&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fields</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dns.qry.name</span></span></code></pre></div></li><li><p><strong>–ü–æ–∏—Å–∫ C2-—Ç—Ä–∞—Ñ–∏–∫–∞ (Command &amp; Control)</strong>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tshark</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;http and http.host contains &quot;pastebin.com&quot;&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> json</span></span></code></pre></div></li></ul><hr><h3 id="_4-—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ-tcpdump-vs-tshark" tabindex="-1"><strong>4. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ tcpdump vs tshark</strong> <a class="header-anchor" href="#_4-—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ-tcpdump-vs-tshark" aria-label="Permalink to &quot;**4. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ tcpdump vs tshark**&quot;">‚Äã</a></h3><table tabindex="0"><thead><tr><th>–ö—Ä–∏—Ç–µ—Ä–∏–π</th><th><code>tcpdump</code></th><th><code>tshark</code></th></tr></thead><tbody><tr><td><strong>–°–∫–æ—Ä–æ—Å—Ç—å</strong></td><td>–í—ã—à–µ (–º–µ–Ω—å—à–µ –æ–≤–µ—Ä—Ö–µ–¥–∞)</td><td>–ù–∏–∂–µ (–≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑)</td></tr><tr><td><strong>–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è</strong></td><td>BPF (–Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è)</td><td>–î–∏—Å–ø–ª–µ–π-—Ñ–∏–ª—å—Ç—Ä—ã (–ø—Ä–æ—Ç–æ–∫–æ–ª—å–Ω—ã–µ)</td></tr><tr><td><strong>–®–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫</strong></td><td>–¢–æ–ª—å–∫–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏</td><td>–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∫–ª—é—á–µ–π</td></tr><tr><td><strong>–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</strong></td><td>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π</td><td>JSON, CSV, XML, Lua</td></tr><tr><td><strong>–û–±—É—á–µ–Ω–∏–µ</strong></td><td>–ü—Ä–æ—â–µ</td><td>–¢—Ä–µ–±—É–µ—Ç –∑–Ω–∞–Ω–∏—è Wireshark</td></tr><tr><td><strong>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö</strong></td><td>–ò–¥–µ–∞–ª–µ–Ω</td><td>–°–ª–æ–∂–Ω–µ–µ –∏–∑-–∑–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤</td></tr></tbody></table><blockquote><p>üí° <strong>–°–æ–≤–µ—Ç</strong>: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ <code>tcpdump</code> –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞—Ö–≤–∞—Ç–∞, –∞ <code>tshark</code> ‚Äî –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.</p></blockquote><hr><h2 id="–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è-—á–∞—Å—Ç—å-–∑–∞–¥–∞–Ω–∏—è-–ø–æ-–∞–Ω–∞–ª–∏–∑—É-—Ç—Ä–∞—Ñ–∏–∫–∞" tabindex="-1"><strong>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å: –∑–∞–¥–∞–Ω–∏—è –ø–æ –∞–Ω–∞–ª–∏–∑—É —Ç—Ä–∞—Ñ–∏–∫–∞</strong> <a class="header-anchor" href="#–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è-—á–∞—Å—Ç—å-–∑–∞–¥–∞–Ω–∏—è-–ø–æ-–∞–Ω–∞–ª–∏–∑—É-—Ç—Ä–∞—Ñ–∏–∫–∞" aria-label="Permalink to &quot;**–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å: –∑–∞–¥–∞–Ω–∏—è –ø–æ –∞–Ω–∞–ª–∏–∑—É —Ç—Ä–∞—Ñ–∏–∫–∞**&quot;">‚Äã</a></h2><h3 id="–∑–∞–¥–∞–Ω–∏–µ-1-–±–∞–∑–æ–≤—ã–∏-–∑–∞—Ö–≤–∞—Ç-—Ç—Ä–∞—Ñ–∏–∫–∞" tabindex="-1"><strong>–ó–∞–¥–∞–Ω–∏–µ 1: –ë–∞–∑–æ–≤—ã–π –∑–∞—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞</strong> <a class="header-anchor" href="#–∑–∞–¥–∞–Ω–∏–µ-1-–±–∞–∑–æ–≤—ã–∏-–∑–∞—Ö–≤–∞—Ç-—Ç—Ä–∞—Ñ–∏–∫–∞" aria-label="Permalink to &quot;**–ó–∞–¥–∞–Ω–∏–µ 1: –ë–∞–∑–æ–≤—ã–π –∑–∞—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞**&quot;">‚Äã</a></h3><p><strong>–¶–µ–ª—å</strong>: –ù–∞—É—á–∏—Ç—å—Å—è —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫.</p><ol><li><p>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tcpdump</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tshark</span></span></code></pre></div></li><li><p>–ó–∞—Ö–≤–∞—Ç–∏—Ç–µ —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ <code>eth0</code> (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à):</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tcpdump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> eth0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -w</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> initial_capture.pcap</span></span></code></pre></div><ul><li>–í—ã–ø–æ–ª–Ω–∏—Ç–µ 2-3 –¥–µ–π—Å—Ç–≤–∏—è: <code>ping 8.8.8.8</code>, <code>curl http://example.com</code>.</li><li>–û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞—Ö–≤–∞—Ç (<code>Ctrl+C</code>).</li></ul></li><li><p>–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tcpdump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> initial_capture.pcap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -nn</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tshark</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> initial_capture.pcap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http or dns&quot;</span></span></code></pre></div></li></ol><p><strong>–í–æ–ø—Ä–æ—Å—ã –¥–ª—è –æ—Ç—á—ë—Ç–∞</strong>:</p><ul><li>–ö–∞–∫–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –≤—ã –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏?</li><li>–°–∫–æ–ª—å–∫–æ DNS-–∑–∞–ø—Ä–æ—Å–æ–≤ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ example.com?</li></ul><hr><h3 id="–∑–∞–¥–∞–Ω–∏–µ-2-–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ-–∞–Ω–æ–º–∞–ª–∏–∏" tabindex="-1"><strong>–ó–∞–¥–∞–Ω–∏–µ 2: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π</strong> <a class="header-anchor" href="#–∑–∞–¥–∞–Ω–∏–µ-2-–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ-–∞–Ω–æ–º–∞–ª–∏–∏" aria-label="Permalink to &quot;**–ó–∞–¥–∞–Ω–∏–µ 2: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π**&quot;">‚Äã</a></h3><p><strong>–¶–µ–ª—å</strong>: –ù–∞–π—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∞—Ç–∞–∫–∏ –≤ —Ç—Ä–∞—Ñ–∏–∫–µ.</p><ol><li><p>–°–∫–∞—á–∞–π—Ç–µ <a href="https://www.malware-traffic-analysis.net/2023/01/13/index.html" target="_blank" rel="noreferrer">–æ–±—Ä–∞–∑–µ—Ü –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞</a> (–≤—ã–±–µ—Ä–∏—Ç–µ PCAP-—Ñ–∞–π–ª).</p></li><li><p>–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –µ–≥–æ:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tshark</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> malware.pcap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fields</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http.host</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http.request.uri</span></span></code></pre></div></li><li><p>–ù–∞–π–¥–∏—Ç–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–º–µ–Ω—ã:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tshark</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> malware.pcap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;dns&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;malicious&quot;</span></span></code></pre></div></li></ol><p><strong>–í–æ–ø—Ä–æ—Å—ã –¥–ª—è –æ—Ç—á—ë—Ç–∞</strong>:</p><ul><li>–ö–∞–∫–∏–µ –¥–æ–º–µ–Ω—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è C2?</li><li>–ö–∞–∫–æ–π HTTP-–º–µ—Ç–æ–¥ —á–∞—â–µ –≤—Å–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Ä–µ–¥–æ–Ω–æ—Å–æ–º?</li></ul><hr><h3 id="–∑–∞–¥–∞–Ω–∏–µ-3-–∞–Ω–∞–ª–∏–∑-—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ-—Ç—Ä–∞—Ñ–∏–∫–∞" tabindex="-1"><strong>–ó–∞–¥–∞–Ω–∏–µ 3: –ê–Ω–∞–ª–∏–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞</strong> <a class="header-anchor" href="#–∑–∞–¥–∞–Ω–∏–µ-3-–∞–Ω–∞–ª–∏–∑-—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ-—Ç—Ä–∞—Ñ–∏–∫–∞" aria-label="Permalink to &quot;**–ó–∞–¥–∞–Ω–∏–µ 3: –ê–Ω–∞–ª–∏–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞**&quot;">‚Äã</a></h3><p><strong>–¶–µ–ª—å</strong>: –ù–∞—É—á–∏—Ç—å—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —Å TLS-—Ç—Ä–∞—Ñ–∏–∫–æ–º.</p><ol><li><p>–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Ç—Ä–∞—Ñ–∏–∫ —Å HTTPS:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://google.com</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/null</span></span></code></pre></div></li><li><p>–ó–∞—Ö–≤–∞—Ç–∏—Ç–µ —Ç—Ä–∞—Ñ–∏–∫:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tcpdump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> eth0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -w</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tls_capture.pcap</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> port</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 443</span></span></code></pre></div></li><li><p>–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —á–µ—Ä–µ–∑ <code>tshark</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tshark</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tls_capture.pcap</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;tls.handshake&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fields</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tls.handshake.ciphersuite</span></span></code></pre></div></li></ol><p><strong>–í–æ–ø—Ä–æ—Å—ã –¥–ª—è –æ—Ç—á—ë—Ç–∞</strong>:</p><ul><li>–ö–∞–∫–∞—è –≤–µ—Ä—Å–∏—è TLS –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è?</li><li>–ö–∞–∫–æ–π —à–∏—Ñ—Ä–Ω–∞–±–æ—Ä (ciphersuite) –≤—ã–±—Ä–∞–Ω? –ù–∞–π–¥–∏—Ç–µ –µ–≥–æ –æ–ø–∏—Å–∞–Ω–∏–µ –≤ <a href="https://tools.ietf.org/html/rfc8446" target="_blank" rel="noreferrer">RFC 8446</a>.</li></ul><hr><h3 id="–∑–∞–¥–∞–Ω–∏–µ-4-–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è-–∞–Ω–∞–ª–∏–∑–∞-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ" tabindex="-1"><strong>–ó–∞–¥–∞–Ω–∏–µ 4: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ (–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ)</strong> <a class="header-anchor" href="#–∑–∞–¥–∞–Ω–∏–µ-4-–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è-–∞–Ω–∞–ª–∏–∑–∞-–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ" aria-label="Permalink to &quot;**–ó–∞–¥–∞–Ω–∏–µ 4: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ (–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ)**&quot;">‚Äã</a></h3><p><strong>–¶–µ–ª—å</strong>: –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è SYN-—Ñ–ª—É–¥–∞.</p><ol><li><p>–ù–∞–ø–∏—à–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç <code>syn_flood_detector.sh</code>:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">#!/bin/bash</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">THRESHOLD</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">100</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # –ü–æ—Ä–æ–≥ SYN-–ø–∞–∫–µ—Ç–æ–≤ –∑–∞ 10 —Å–µ–∫—É–Ω–¥</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">INTERFACE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;eth0&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Monitoring SYN flood on </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$INTERFACE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">...&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">while</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  COUNT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tcpdump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $INTERFACE </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-c</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $THRESHOLD </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;tcp[13] &amp; 2 != 0&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> 2&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/dev/null</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> wc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -l</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [ $COUNT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-ge</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $THRESHOLD ]; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">then</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    echo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;[ALERT] Possible SYN flood! $(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">date</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tee</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> syn_flood.log</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tcpdump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $INTERFACE </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-w</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;syn_flood_$(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">date</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +%s).pcap&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 100</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;tcp[13] &amp; 2 != 0&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  fi</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  sleep</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">done</span></span></code></pre></div></li><li><p>–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤ —Ñ–æ–Ω–µ:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">chmod</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> +x</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> syn_flood_detector.sh</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./syn_flood_detector.sh</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> &amp;</span></span></code></pre></div></li><li><p>–ò–º–∏—Ç–∏—Ä—É–π—Ç–µ –∞—Ç–∞–∫—É (–≤ –¥—Ä—É–≥–æ–π —Å–µ—Å—Å–∏–∏):</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1..150}</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">do</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> nc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -z</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -w</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 127.0.0.1</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 80</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">done</span></span></code></pre></div></li></ol><p><strong>–í–æ–ø—Ä–æ—Å—ã –¥–ª—è –æ—Ç—á—ë—Ç–∞</strong>:</p><ul><li>–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è?</li><li>–ö–∞–∫ —É–ª—É—á—à–∏—Ç—å —Å–∫—Ä–∏–ø—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–±–∞–≤–∏—Ç—å —É—á—ë—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∞—Ç–∞–∫–∏)?</li></ul><hr><h2 id="–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ-–≤–æ–ø—Ä–æ—Å—ã" tabindex="-1"><strong>–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã</strong> <a class="header-anchor" href="#–∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ-–≤–æ–ø—Ä–æ—Å—ã" aria-label="Permalink to &quot;**–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã**&quot;">‚Äã</a></h2><ol><li><p><strong>–ß–µ–º BPF-—Ñ–∏–ª—å—Ç—Ä—ã –≤ <code>tcpdump</code> –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç –¥–∏—Å–ø–ª–µ–π-—Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ <code>tshark</code>?</strong></p><ul><li>BPF: —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ —è–¥—Ä–∞ (–¥–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏), —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏.</li><li>–î–∏—Å–ø–ª–µ–π-—Ñ–∏–ª—å—Ç—Ä—ã: –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç —É–∂–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã, —Ä–∞–±–æ—Ç–∞—é—Ç —Å –ª–æ–≥–∏–∫–æ–π –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤.</li></ul></li><li><p><strong>–ö–∞–∫ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å DNS-—Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é <code>tshark</code>?</strong></p><ul><li>–ò—Å–∫–∞—Ç—å –∞–Ω–æ–º–∞–ª—å–Ω–æ –¥–ª–∏–Ω–Ω—ã–µ DNS-–∑–∞–ø—Ä–æ—Å—ã: <code>tshark -Y &quot;dns.qry.name.len &gt; 50&quot;</code>.</li></ul></li><li><p><strong>–ü–æ—á–µ–º—É <code>tcpdump</code> –Ω–µ –º–æ–∂–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ HTTPS-—Ç—Ä–∞—Ñ–∏–∫–∞?</strong></p><ul><li>TLS —à–∏—Ñ—Ä—É–µ—Ç payload. –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –Ω—É–∂–µ–Ω –∫–ª—é—á —Å–µ—Å—Å–∏–∏ –∏–ª–∏ MITM (—Ç–æ–ª—å–∫–æ –≤ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ä–µ–¥–∞—Ö).</li></ul></li><li><p><strong>–ö–∞–∫ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤ —Ñ–∞–π–ª?</strong></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tshark</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -i</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> eth0</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Y</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -T</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> fields</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http.request.method</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http.host</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -e</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http.user_agent</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http_headers.txt</span></span></code></pre></div></li></ol><hr><h2 id="–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ-–º–∞—Ç–µ—Ä–∏–∞–ª—ã-–¥–ª—è-—É–≥–ª—É–±–ª–µ–Ω–Ω–æ–≥–æ-–∏–∑—É—á–µ–Ω–∏—è" tabindex="-1"><strong>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è —É–≥–ª—É–±–ª—ë–Ω–Ω–æ–≥–æ –∏–∑—É—á–µ–Ω–∏—è</strong> <a class="header-anchor" href="#–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ-–º–∞—Ç–µ—Ä–∏–∞–ª—ã-–¥–ª—è-—É–≥–ª—É–±–ª–µ–Ω–Ω–æ–≥–æ-–∏–∑—É—á–µ–Ω–∏—è" aria-label="Permalink to &quot;**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è —É–≥–ª—É–±–ª—ë–Ω–Ω–æ–≥–æ –∏–∑—É—á–µ–Ω–∏—è**&quot;">‚Äã</a></h2><ol><li><p><strong>–ö–Ω–∏–≥–∏</strong>:</p><ul><li><em>Packet Analysis with Wireshark</em> ‚Äî Laura Chappell</li><li><em>Network Security Assessment</em> ‚Äî Chris McNab (–≥–ª–∞–≤–∞ 3: Network Enumeration)</li></ul></li><li><p><strong>–û–Ω–ª–∞–π–Ω-—Ä–µ—Å—É—Ä—Å—ã</strong>:</p><ul><li><a href="https://www.wireshark.org/docs/dfref/" target="_blank" rel="noreferrer">Wireshark Display Filter Reference</a></li><li><a href="https://www.tcpdump.org/manpages/tcpdump.1.html" target="_blank" rel="noreferrer">tcpdump man page</a></li><li><a href="https://www.malware-traffic-analysis.net/" target="_blank" rel="noreferrer">Malware Traffic Analysis</a> ‚Äî —Ä–µ–∞–ª—å–Ω—ã–µ PCAP-—Ñ–∞–π–ª—ã</li></ul></li><li><p><strong>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</strong>:</p><ul><li><code>zeek</code> (—Ä–∞–Ω–µ–µ Bro) ‚Äî —Å–∏—Å—Ç–µ–º–∞ —Å–µ—Ç–µ–≤–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.</li><li><code>suricata</code> ‚Äî IDS —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Lua-—Å–∫—Ä–∏–ø—Ç–æ–≤.</li><li><code>ngrep</code> ‚Äî grep –¥–ª—è —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞.</li></ul></li></ol><hr><h2 id="–∑–∞–∫–ª—é—á–µ–Ω–∏–µ" tabindex="-1"><strong>–ó–∞–∫–ª—é—á–µ–Ω–∏–µ</strong> <a class="header-anchor" href="#–∑–∞–∫–ª—é—á–µ–Ω–∏–µ" aria-label="Permalink to &quot;**–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**&quot;">‚Äã</a></h2><p>–ê–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ ‚Äî —ç—Ç–æ <strong>–∫–ª—é—á–µ–≤–æ–π –Ω–∞–≤—ã–∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –ø–æ –ò–ë</strong>. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤—Ä–æ–¥–µ <code>tcpdump</code> –∏ <code>tshark</code> –ø–æ–∑–≤–æ–ª—è—é—Ç:</p><ul><li><strong>–í–∏–¥–µ—Ç—å –Ω–µ–≤–∏–¥–∏–º–æ–µ</strong>: –¢–æ, —á—Ç–æ —Å–∫—Ä—ã—Ç–æ –æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ª–æ–≥–æ–≤.</li><li><strong>–†–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –º–≥–Ω–æ–≤–µ–Ω–Ω–æ</strong>: –ù–∞ —ç—Ç–∞–ø–µ –∞—Ç–∞–∫–∏, –∞ –Ω–µ –ø–æ—Å–ª–µ –µ—ë –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è.</li><li><strong>–ì–æ–≤–æ—Ä–∏—Ç—å –Ω–∞ —è–∑—ã–∫–µ –¥–∞–Ω–Ω—ã—Ö</strong>: –ó–∞–º–µ–Ω—è—Ç—å –¥–æ–≥–∞–¥–∫–∏ ‚Äî —Ñ–∞–∫—Ç–∞–º–∏.</li></ul><p>üí° <strong>–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å–æ–≤–µ—Ç</strong>:</p><blockquote><p>&quot;–ï—Å–ª–∏ –≤—ã –Ω–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç–µ —Ç—Ä–∞—Ñ–∏–∫ —Å–≤–æ–µ–π —Å–µ—Ç–∏ ‚Äî –≤—ã –Ω–µ –∑–Ω–∞–µ—Ç–µ, —á—Ç–æ –≤ –Ω–µ–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.<br> –ù–∞—á–Ω–∏—Ç–µ —Å –ø—Ä–æ—Å—Ç–æ–≥–æ: –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑ 1% —Ç—Ä–∞—Ñ–∏–∫–∞.&quot;</p></blockquote><hr><p><strong>–ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã</strong>:</p><ul><li>–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–¥–∞–Ω–∏–π (60 –±–∞–ª–ª–æ–≤).</li><li>–û—Ç–≤–µ—Ç—ã –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã (20 –±–∞–ª–ª–æ–≤).</li><li>–ö—Ä–µ–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è (10 –±–∞–ª–ª–æ–≤).</li><li>–°—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –≤ –æ—Ç—á—ë—Ç–µ (10 –±–∞–ª–ª–æ–≤).</li></ul><p><strong>–°—Ä–æ–∫ —Å–¥–∞—á–∏</strong>: 7 –¥–Ω–µ–π.<br><strong>–§–æ—Ä–º–∞—Ç –æ—Ç—á—ë—Ç–∞</strong>: PDF —Å –∫–æ–º–∞–Ω–¥–∞–º–∏, –≤—ã–≤–æ–¥–∞–º–∏ –∏ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞–º–∏.</p>`,72)]))}const F=i(n,[["render",l]]);export{g as __pageData,F as default};
