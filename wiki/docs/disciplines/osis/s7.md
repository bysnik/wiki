# **–°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞: –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã –ø–∞–∫–µ—Ç–æ–≤ `tcpdump` –∏ `tshark` –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ GNU/Linux**

---

## **–ë–ª–æ–∫ —Ç–µ–æ—Ä–∏–∏: –ê–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ –∫–∞–∫ –æ—Å–Ω–æ–≤–∞ –∫–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**

### **1. –ó–∞—á–µ–º –Ω—É–∂–Ω—ã –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä—ã –ø–∞–∫–µ—Ç–æ–≤?**
–°–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫ ‚Äî —ç—Ç–æ "–∫—Ä–æ–≤–µ–Ω–æ—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞" –ª—é–±–æ–π –ò–¢-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –ê–Ω–∞–ª–∏–∑ –ø–∞–∫–µ—Ç–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- **–û–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å –∞—Ç–∞–∫–∏** (—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤, DDoS, MITM).
- **–î–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö** (–Ω–µ–æ–±—ã—á–Ω—ã–π –∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫).
- **–ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–æ–≤**.
- **–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π** (–Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–æ–ª–∏, —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã).
- **–†–∞—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã** (forensic analysis).

> ‚ö†Ô∏è **–í–∞–∂–Ω–æ!** –ó–∞—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞ –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —è–≤–ª—è–µ—Ç—Å—è –Ω–∞—Ä—É—à–µ–Ω–∏–µ–º –∑–∞–∫–æ–Ω–∞ –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å—Ç—Ä–∞–Ω. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã **—Ç–æ–ª—å–∫–æ –≤ —Ä–∞–º–∫–∞—Ö —ç—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ö–∞–∫–∏–Ω–≥–∞ –∏–ª–∏ –Ω–∞ —Å–≤–æ–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö**.

---

### **2. `tcpdump` ‚Äî –∫–æ–Ω—Å–æ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä —Ç—Ä–∞—Ñ–∏–∫–∞**

#### **–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**
- **–õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π**: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ—Å—É—Ä—Å–∞–º.
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ –ª–µ—Ç—É**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ BPF (Berkeley Packet Filter).
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª**: –î–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏**: Suricata, Zeek, Wireshark.

#### **–û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø—Ü–∏–∏**
| –û–ø—Ü–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|-------|------------|--------|
| `-i` | –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å | `tcpdump -i eth0` |
| `-w` | –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª | `tcpdump -w capture.pcap` |
| `-r` | –ü—Ä–æ—á–∏—Ç–∞—Ç—å –∏–∑ —Ñ–∞–π–ª–∞ | `tcpdump -r capture.pcap` |
| `-nn` | –ù–µ —Ä–∞–∑—Ä–µ—à–∞—Ç—å –∏–º–µ–Ω–∞ | `tcpdump -nn port 53` |
| `-c` | –õ–∏–º–∏—Ç –ø–∞–∫–µ—Ç–æ–≤ | `tcpdump -c 10 host 192.168.1.1` |
| `-s` | –†–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ | `tcpdump -s 0` (–ø–æ–ª–Ω—ã–π –¥–∞–º–ø) |

#### **–ü—Ä–∏–º–µ—Ä—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ BPF**
```bash
# –¢—Ä–∞—Ñ–∏–∫ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É IP
tcpdump host 192.168.1.100

# DNS-–∑–∞–ø—Ä–æ—Å—ã
tcpdump port 53

# HTTP-—Ç—Ä–∞—Ñ–∏–∫ (–Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π)
tcpdump port 80

# SYN-—Ñ–ª—É–¥ (–∞—Ç–∞–∫–∞)
tcpdump 'tcp[13] & 2 != 0' and src 10.0.0.5

# –¢—Ä–∞—Ñ–∏–∫ –∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º—É –ø–æ—Ä—Ç—É
tcpdump dst port 22
```

#### **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –ò–ë**
- **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ä—Ç–æ–≤**:
  ```bash
  tcpdump 'tcp[13] == 2' | awk '{print $3}' | sort | uniq -c
  ```
  –ï—Å–ª–∏ –æ–¥–∏–Ω IP –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º–Ω–æ–≥–æ SYN-–ø–∞–∫–µ—Ç–æ–≤ ‚Äî –≤–µ—Ä–æ—è—Ç–µ–Ω port scan.

- **–ü–æ–∏—Å–∫ —É—Ç–µ—á–µ–∫ –¥–∞–Ω–Ω—ã—Ö**:
  ```bash
  tcpdump -A -i eth0 'tcp port 80 and (http contains "password" or http contains "token")'
  ```

---

### **3. `tshark` ‚Äî –º–æ—â–Ω—ã–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –æ—Ç Wireshark**

#### **–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø–µ—Ä–µ–¥ tcpdump**
- **–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤**: –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ TLS, HTTP/2, DNSSEC.
- **–î–∏—Å–ø–ª–µ–π-—Ñ–∏–ª—å—Ç—Ä—ã**: –ö–∞–∫ –≤ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º Wireshark (`http.request.method == "POST"`).
- **–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö**: –í JSON, CSV, XML.
- **Lua-—Å–∫—Ä–∏–ø—Ç—ã**: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞.

#### **–û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø—Ü–∏–∏**
| –û–ø—Ü–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|-------|------------|--------|
| `-i` | –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å | `tshark -i wlan0` |
| `-Y` | –î–∏—Å–ø–ª–µ–π-—Ñ–∏–ª—å—Ç—Ä | `tshark -Y "http"` |
| `-T` | –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ | `tshark -T json` |
| `-e` | –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –ø–æ–ª–µ | `tshark -e ip.src -e http.host` |
| `-qz` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ | `tshark -qz io,phs` |

#### **–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**
```bash
# –ê–Ω–∞–ª–∏–∑ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤
tshark -i eth0 -Y "http" -T fields -e http.host -e http.request.uri

# –ü–æ–∏—Å–∫ –ø–æ–ø—ã—Ç–æ–∫ SQL-–∏–Ω—ä–µ–∫—Ü–∏–π
tshark -Y 'http contains "SELECT * FROM"' -T json

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º
tshark -qz io,phs

# –ê–Ω–∞–ª–∏–∑ TLS-—Ä—É–∫–æ–ø–æ–∂–∞—Ç–∏–π (—É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –≤–µ—Ä—Å–∏–∏)
tshark -Y 'tls.handshake' -T fields -e tls.handshake.version
```

#### **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –ò–ë**
- **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É—è–∑–≤–∏–º—ã—Ö SSL/TLS-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π**:
  ```bash
  tshark -Y 'tls.handshake.ciphersuite == 0x0035'  # –ü–æ–∏—Å–∫ SSLv3 (—É—è–∑–≤–∏–º –∫ POODLE)
  ```

- **–ê–Ω–∞–ª–∏–∑ DNS-—Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è**:
  ```bash
  tshark -Y 'dns.qry.name contains "malicious"' -T fields -e dns.qry.name
  ```

- **–ü–æ–∏—Å–∫ C2-—Ç—Ä–∞—Ñ–∏–∫–∞ (Command & Control)**:
  ```bash
  tshark -Y 'http and http.host contains "pastebin.com"' -T json
  ```

---

### **4. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ tcpdump vs tshark**

| –ö—Ä–∏—Ç–µ—Ä–∏–π | `tcpdump` | `tshark` |
|----------|-----------|----------|
| **–°–∫–æ—Ä–æ—Å—Ç—å** | –í—ã—à–µ (–º–µ–Ω—å—à–µ –æ–≤–µ—Ä—Ö–µ–¥–∞) | –ù–∏–∂–µ (–≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑) |
| **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è** | BPF (–Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è) | –î–∏—Å–ø–ª–µ–π-—Ñ–∏–ª—å—Ç—Ä—ã (–ø—Ä–æ—Ç–æ–∫–æ–ª—å–Ω—ã–µ) |
| **–®–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç—Ä–∞—Ñ–∏–∫** | –¢–æ–ª—å–∫–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏ | –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∫–ª—é—á–µ–π |
| **–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö** | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π | JSON, CSV, XML, Lua |
| **–û–±—É—á–µ–Ω–∏–µ** | –ü—Ä–æ—â–µ | –¢—Ä–µ–±—É–µ—Ç –∑–Ω–∞–Ω–∏—è Wireshark |
| **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö** | –ò–¥–µ–∞–ª–µ–Ω | –°–ª–æ–∂–Ω–µ–µ –∏–∑-–∑–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤ |

> üí° **–°–æ–≤–µ—Ç**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `tcpdump` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞—Ö–≤–∞—Ç–∞, –∞ `tshark` ‚Äî –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.

---

## **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å: –∑–∞–¥–∞–Ω–∏—è –ø–æ –∞–Ω–∞–ª–∏–∑—É —Ç—Ä–∞—Ñ–∏–∫–∞**

### **–ó–∞–¥–∞–Ω–∏–µ 1: –ë–∞–∑–æ–≤—ã–π –∑–∞—Ö–≤–∞—Ç —Ç—Ä–∞—Ñ–∏–∫–∞**
**–¶–µ–ª—å**: –ù–∞—É—á–∏—Ç—å—Å—è —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫.

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:
   ```bash
   sudo apt install tcpdump tshark
   ```

2. –ó–∞—Ö–≤–∞—Ç–∏—Ç–µ —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ `eth0` (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à):
   ```bash
   sudo tcpdump -i eth0 -w initial_capture.pcap
   ```
   - –í—ã–ø–æ–ª–Ω–∏—Ç–µ 2-3 –¥–µ–π—Å—Ç–≤–∏—è: `ping 8.8.8.8`, `curl http://example.com`.
   - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞—Ö–≤–∞—Ç (`Ctrl+C`).

3. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª:
   ```bash
   tcpdump -r initial_capture.pcap -nn
   tshark -r initial_capture.pcap -Y "http or dns"
   ```

**–í–æ–ø—Ä–æ—Å—ã –¥–ª—è –æ—Ç—á—ë—Ç–∞**:
- –ö–∞–∫–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª—ã –≤—ã –æ–±–Ω–∞—Ä—É–∂–∏–ª–∏?
- –°–∫–æ–ª—å–∫–æ DNS-–∑–∞–ø—Ä–æ—Å–æ–≤ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ example.com?

---

### **–ó–∞–¥–∞–Ω–∏–µ 2: –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π**
**–¶–µ–ª—å**: –ù–∞–π—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∞—Ç–∞–∫–∏ –≤ —Ç—Ä–∞—Ñ–∏–∫–µ.

1. –°–∫–∞—á–∞–π—Ç–µ [–æ–±—Ä–∞–∑–µ—Ü –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞](https://www.malware-traffic-analysis.net/2023/01/13/index.html) (–≤—ã–±–µ—Ä–∏—Ç–µ PCAP-—Ñ–∞–π–ª).

2. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –µ–≥–æ:
   ```bash
   tshark -r malware.pcap -Y "http" -T fields -e http.host -e http.request.uri
   ```

3. –ù–∞–π–¥–∏—Ç–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–º–µ–Ω—ã:
   ```bash
   tshark -r malware.pcap -Y "dns" | grep -i "malicious"
   ```

**–í–æ–ø—Ä–æ—Å—ã –¥–ª—è –æ—Ç—á—ë—Ç–∞**:
- –ö–∞–∫–∏–µ –¥–æ–º–µ–Ω—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è C2?
- –ö–∞–∫–æ–π HTTP-–º–µ—Ç–æ–¥ —á–∞—â–µ –≤—Å–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Ä–µ–¥–æ–Ω–æ—Å–æ–º?

---

### **–ó–∞–¥–∞–Ω–∏–µ 3: –ê–Ω–∞–ª–∏–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞**
**–¶–µ–ª—å**: –ù–∞—É—á–∏—Ç—å—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —Å TLS-—Ç—Ä–∞—Ñ–∏–∫–æ–º.

1. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Ç—Ä–∞—Ñ–∏–∫ —Å HTTPS:
   ```bash
   curl https://google.com > /dev/null
   ```

2. –ó–∞—Ö–≤–∞—Ç–∏—Ç–µ —Ç—Ä–∞—Ñ–∏–∫:
   ```bash
   sudo tcpdump -i eth0 -w tls_capture.pcap port 443
   ```

3. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —á–µ—Ä–µ–∑ `tshark`:
   ```bash
   tshark -r tls_capture.pcap -Y "tls.handshake" -T fields -e tls.handshake.ciphersuite
   ```

**–í–æ–ø—Ä–æ—Å—ã –¥–ª—è –æ—Ç—á—ë—Ç–∞**:
- –ö–∞–∫–∞—è –≤–µ—Ä—Å–∏—è TLS –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è?
- –ö–∞–∫–æ–π —à–∏—Ñ—Ä–Ω–∞–±–æ—Ä (ciphersuite) –≤—ã–±—Ä–∞–Ω? –ù–∞–π–¥–∏—Ç–µ –µ–≥–æ –æ–ø–∏—Å–∞–Ω–∏–µ –≤ [RFC 8446](https://tools.ietf.org/html/rfc8446).

---

### **–ó–∞–¥–∞–Ω–∏–µ 4: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ (–ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ)**
**–¶–µ–ª—å**: –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è SYN-—Ñ–ª—É–¥–∞.

1. –ù–∞–ø–∏—à–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç `syn_flood_detector.sh`:
   ```bash
   #!/bin/bash
   THRESHOLD=100  # –ü–æ—Ä–æ–≥ SYN-–ø–∞–∫–µ—Ç–æ–≤ –∑–∞ 10 —Å–µ–∫—É–Ω–¥
   INTERFACE="eth0"

   echo "Monitoring SYN flood on $INTERFACE..."
   while true; do
     COUNT=$(sudo tcpdump -i $INTERFACE -c $THRESHOLD 'tcp[13] & 2 != 0' 2>/dev/null | wc -l)
     if [ $COUNT -ge $THRESHOLD ]; then
       echo "[ALERT] Possible SYN flood! $(date)" | tee -a syn_flood.log
       sudo tcpdump -i $INTERFACE -w "syn_flood_$(date +%s).pcap" -c 100 'tcp[13] & 2 != 0'
     fi
     sleep 10
   done
   ```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤ —Ñ–æ–Ω–µ:
   ```bash
   chmod +x syn_flood_detector.sh
   ./syn_flood_detector.sh &
   ```

3. –ò–º–∏—Ç–∏—Ä—É–π—Ç–µ –∞—Ç–∞–∫—É (–≤ –¥—Ä—É–≥–æ–π —Å–µ—Å—Å–∏–∏):
   ```bash
   for i in {1..150}; do nc -z -w 1 127.0.0.1 80; done
   ```

**–í–æ–ø—Ä–æ—Å—ã –¥–ª—è –æ—Ç—á—ë—Ç–∞**:
- –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è?
- –ö–∞–∫ —É–ª—É—á—à–∏—Ç—å —Å–∫—Ä–∏–ø—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–±–∞–≤–∏—Ç—å —É—á—ë—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∞—Ç–∞–∫–∏)?

---

## **–ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã**

1. **–ß–µ–º BPF-—Ñ–∏–ª—å—Ç—Ä—ã –≤ `tcpdump` –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç –¥–∏—Å–ø–ª–µ–π-—Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ `tshark`?**
   - BPF: —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ —è–¥—Ä–∞ (–¥–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏), —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏.
   - –î–∏—Å–ø–ª–µ–π-—Ñ–∏–ª—å—Ç—Ä—ã: –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç —É–∂–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã, —Ä–∞–±–æ—Ç–∞—é—Ç —Å –ª–æ–≥–∏–∫–æ–π –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤.

2. **–ö–∞–∫ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å DNS-—Ç—É–Ω–Ω–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é `tshark`?**
   - –ò—Å–∫–∞—Ç—å –∞–Ω–æ–º–∞–ª—å–Ω–æ –¥–ª–∏–Ω–Ω—ã–µ DNS-–∑–∞–ø—Ä–æ—Å—ã: `tshark -Y "dns.qry.name.len > 50"`.

3. **–ü–æ—á–µ–º—É `tcpdump` –Ω–µ –º–æ–∂–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ HTTPS-—Ç—Ä–∞—Ñ–∏–∫–∞?**
   - TLS —à–∏—Ñ—Ä—É–µ—Ç payload. –î–ª—è –∞–Ω–∞–ª–∏–∑–∞ –Ω—É–∂–µ–Ω –∫–ª—é—á —Å–µ—Å—Å–∏–∏ –∏–ª–∏ MITM (—Ç–æ–ª—å–∫–æ –≤ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ä–µ–¥–∞—Ö).

4. **–ö–∞–∫ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ HTTP-–∑–∞–≥–æ–ª–æ–≤–∫–∏ –≤ —Ñ–∞–π–ª?**
   ```bash
   tshark -i eth0 -Y "http" -T fields -e http.request.method -e http.host -e http.user_agent > http_headers.txt
   ```

---

## **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è —É–≥–ª—É–±–ª—ë–Ω–Ω–æ–≥–æ –∏–∑—É—á–µ–Ω–∏—è**

1. **–ö–Ω–∏–≥–∏**:
   - *Packet Analysis with Wireshark* ‚Äî Laura Chappell
   - *Network Security Assessment* ‚Äî Chris McNab (–≥–ª–∞–≤–∞ 3: Network Enumeration)

2. **–û–Ω–ª–∞–π–Ω-—Ä–µ—Å—É—Ä—Å—ã**:
   - [Wireshark Display Filter Reference](https://www.wireshark.org/docs/dfref/)
   - [tcpdump man page](https://www.tcpdump.org/manpages/tcpdump.1.html)
   - [Malware Traffic Analysis](https://www.malware-traffic-analysis.net/) ‚Äî —Ä–µ–∞–ª—å–Ω—ã–µ PCAP-—Ñ–∞–π–ª—ã

3. **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã**:
   - `zeek` (—Ä–∞–Ω–µ–µ Bro) ‚Äî —Å–∏—Å—Ç–µ–º–∞ —Å–µ—Ç–µ–≤–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.
   - `suricata` ‚Äî IDS —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Lua-—Å–∫—Ä–∏–ø—Ç–æ–≤.
   - `ngrep` ‚Äî grep –¥–ª—è —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞.

---

## **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**

–ê–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞ ‚Äî —ç—Ç–æ **–∫–ª—é—á–µ–≤–æ–π –Ω–∞–≤—ã–∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –ø–æ –ò–ë**. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤—Ä–æ–¥–µ `tcpdump` –∏ `tshark` –ø–æ–∑–≤–æ–ª—è—é—Ç:
- **–í–∏–¥–µ—Ç—å –Ω–µ–≤–∏–¥–∏–º–æ–µ**: –¢–æ, —á—Ç–æ —Å–∫—Ä—ã—Ç–æ –æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ª–æ–≥–æ–≤.
- **–†–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –º–≥–Ω–æ–≤–µ–Ω–Ω–æ**: –ù–∞ —ç—Ç–∞–ø–µ –∞—Ç–∞–∫–∏, –∞ –Ω–µ –ø–æ—Å–ª–µ –µ—ë –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è.
- **–ì–æ–≤–æ—Ä–∏—Ç—å –Ω–∞ —è–∑—ã–∫–µ –¥–∞–Ω–Ω—ã—Ö**: –ó–∞–º–µ–Ω—è—Ç—å –¥–æ–≥–∞–¥–∫–∏ ‚Äî —Ñ–∞–∫—Ç–∞–º–∏.

üí° **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Å–æ–≤–µ—Ç**:  
> "–ï—Å–ª–∏ –≤—ã –Ω–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç–µ —Ç—Ä–∞—Ñ–∏–∫ —Å–≤–æ–µ–π —Å–µ—Ç–∏ ‚Äî –≤—ã –Ω–µ –∑–Ω–∞–µ—Ç–µ, —á—Ç–æ –≤ –Ω–µ–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.  
> –ù–∞—á–Ω–∏—Ç–µ —Å –ø—Ä–æ—Å—Ç–æ–≥–æ: –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑ 1% —Ç—Ä–∞—Ñ–∏–∫–∞."

---

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã**:
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–¥–∞–Ω–∏–π (60 –±–∞–ª–ª–æ–≤).
- –û—Ç–≤–µ—Ç—ã –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã (20 –±–∞–ª–ª–æ–≤).
- –ö—Ä–µ–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è (10 –±–∞–ª–ª–æ–≤).
- –°—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –≤ –æ—Ç—á—ë—Ç–µ (10 –±–∞–ª–ª–æ–≤).

**–°—Ä–æ–∫ —Å–¥–∞—á–∏**: 7 –¥–Ω–µ–π.  
**–§–æ—Ä–º–∞—Ç –æ—Ç—á—ë—Ç–∞**: PDF —Å –∫–æ–º–∞–Ω–¥–∞–º–∏, –≤—ã–≤–æ–¥–∞–º–∏ –∏ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞–º–∏.